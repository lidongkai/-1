!function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="//store.res.meizu.com//order/",e(0)}(function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))switch(typeof t[e]){case"function":break;case"object":t[e]=function(e){var i=e.slice(1),n=t[e[0]];return function(t,e,o){n.apply(this,[t,e,o].concat(i))}}(t[e]);break;default:t[e]=t[t[e]]}return t}([function(t,e,i){i(1);var n=i(7),o=i(8),s=i(14),r=i(18),a=i(29)(),c=i(30),d=i(40),l=i(51),u=n.extend(!0,{},window.global.data),p=n("#totalOrderPrice"),h=n("#totalExpressPrice"),v=n("#totalPayPrice"),m=n("#validCode"),f=n("#submitForm"),y=n("#totalTips"),g=new o({title:"提示",type:"tips"}),x=null;u.codeRule.display&&(x=new r({selector:m,len:u.codeRule.len,type:u.codeRule.type,sid:u.codeRule.verifySid}).on("click",function(){this.$element.css("width",318)}).on("hide",function(){this.$element.css("width",210)}),x.$element.attr({"data-mdesc":"验证码","data-mtype":"store_se_code"}));var b=function(){var t=d.getCountEndProd(),e=new o({type:"tips",title:"提示",buttons:[{type:"success",text:"上一步",callback:function(){window.location.replace(u.refererUrl)}}]});if(t.length)return e.show({content:t.join(",")+"的价格已发生变化，请重新下单！"}),!1;var i=c.getActiveAddressId();if(null===i)return g.show({content:"请选择收货人地址"}),!1;if(u.codeRule.display&&!x.getValidateState())return y.text("请先通过安全验证"),!1;y.empty();var n=u.codeRule.display?x.getValidateCode():"";k(i,n)},k=function(t,e){var i=d.getProductPointer(),n=Object.keys(i).sort(function(t,e){return i[t].index-i[e].index}).map(function(t){var e=i[t],n={invoiceType:e.invoiceType};return e.invoiceType&&(n.invoiceOrg=e.invoiceOrg,n.invoiceTitle=e.invoiceTitle,2===n.invoiceType&&"03"===n.invoiceOrg&&(n.invoiceTitle=c.getAddressObjectById().receiver),"01"===e.invoiceOrg&&(n.invoiceIdentifySn=e.invoiceIdentifySn,n.invoiceBank=e.invoiceBank,n.invoiceBankAccount=e.invoiceBankAccount)),e.remark&&(n.remark=e.remark),n.orderItems=Object.keys(e.skus).sort(function(t,i){return e.skus[t].index-e.skus[i].index}).map(function(t){var i=e.skus[t],n={skuId:i.skuId,numbers:i.number};return i.packageId&&(n.packageId=i.packageId,n.packageList=i.packageList),n}),n}),o={buyFrom:u.buyFrom,mcode:u.mcode,sourceTime:u.sourceTime,validCode:e,addressId:t,skillTicket:u.skillTicket,buyInfos:JSON.stringify(n)};l.repo.getUseRepoCount()>0&&(o.mcycleTickets=JSON.stringify(l.repo.getSelectedRepo()));var s=l.coupon.getUseCouponId();s&&(o.couponAcquirementId=s);var r=l.red.getUseRedId();r&&(o.redEnvelopeAcquirementId=r),w(o)},w=function(t){a.get(function(e,i){return e?void g.show({content:e}):void n.ajax({url:"/order/submit.html",data:t,headers:{"X-CSRF-TOKEN":i},type:"post",timeout:1e4,beforeSend:s.show.bind(null,"body"),success:function(t){s.hide(),200==t.code?(n(window).off("beforeunload",_),window.location.replace(t.data.url)):t.code>6e3?g.on("hide",function(){n(window).off("beforeunload",_),window.location.replace(t.data.url)}).show({content:t.message}):4e3==t.code?g.once("hide",function(){switch(u.codeRule.display&&x.reset(),t.data.failCouponType){case 1:l.repo.clearRepo();break;case 2:l.coupon.clearCoupon();break;case 3:l.red.clearRed()}}).show({content:t.message}):(u.codeRule.display&&x.reset(),g.show({content:t.message||t.msg}))},error:function(){s.hide(),g.show({content:"网络错误"})}})})},_=function(t){var e="您确定要离开吗？";try{var i=t||window.event;i.returnValue=e}catch(n){}return e},$=function(){p.text(u.totalOrderMoney.toFixed(2)),v.text(u.totalOrderPayMoney.toFixed(2)),h.text(u.totalExpressFee.toFixed(2))},C=function(){c.event.on("selectAddress",T),f.on("click",b)},I=function(t){Object.keys(t).forEach(function(e){t[e].$arrival=n(d.setArrival({fastArrivalStatus:0})).replaceAll(t[e].$arrival)})},T=function(t){if(d.getSupportFastArrival()){var e=d.getProductPointer();a.get(function(i,o){n.ajax({url:"/order/check_fast_arrival",headers:{"X-CSRF-TOKEN":o},data:{skus:u.skus,provinceId:t.provinceId,cityId:t.cityId,areaId:t.areaId,townId:t.townId},type:"post",timeout:1e4,beforeSend:s.show.bind(null,c.$addressModule),success:function(t){200===t.code?Object.keys(t.data).forEach(function(i){e[i].$arrival=n(d.setArrival(t.data[i])).replaceAll(e[i].$arrival)}):I(e),s.hide(c.$addressModule)},error:function(){I(e),s.hide(c.$addressModule)}})})}};c.init(u.address),d.init(u.buyInfoList,u.sysTime),l.init(u.totalOrderPayMoney,u.discountCoupons,u.redCoupons),$(),C()},function(t,e){},,,,,,function(t,e){t.exports=meizuStoreGlobal.jquery},function(t,e,i){i(9);var n=i(7),o=i(11),s=i(12),r="hide",a=function(){return this._events={},s.apply(this,arguments),arguments.length?this.init.apply(this,arguments):this};a.prototype=new s,a.prototype.constructor=a,a.prototype._template=o.template(i(13),{variable:"data"}),a.prototype.defaultOptions={type:"dialog",hasClose:!0,title:"",content:"",contentTitle:"",buttons:[]},a.prototype.init=function(t){var e=this,i={};return i.buttons=[{type:"success",text:"确定",callback:function(){var t=!0;e.emit("beforeSuccess",function(){t=!1}),t&&(e.hide(),e.emit("success"))}}],"tips"!==t.type&&i.buttons.push({type:"cancel",text:"取消",callback:function(){var t=!0;e.emit("beforeCancel",function(){t=!1}),t&&(e.hide(),e.emit("cancel"))}}),this.options=n.extend({},this.defaultOptions,i,t),this.$dialog=n(this._template(this.options)).appendTo("body"),n(".mz-dialog-content",this.$dialog).append(this.options.content),n(".mz-dialog-bottom .mz-btn",this.$dialog).on("click",function(){var t=n(this).index(),i=e.options.buttons[t].callback;n.isFunction(i)&&i.call(e)}),this.options.hasClose&&n(".mz-dialog-close",this.$dialog).on("click",function(){var t=!0;e.emit("beforeClose",function(){t=!1}),t&&(e.hide(),e.emit("close"))}),this._init=!0,this},a.prototype._initDom=function(){return this},a.prototype.show=function(t,e){if(!this._init)return this.init(t).show(t,!0);if(t&&!e&&((t.type||t.className)&&n(".mz-dialog",this.$dialog).attr("class","mz-dialog").addClass((t.type||"")+" "+(t.className||"")),void 0!==t.hasClose&&(t.hasClose?n(".mz-dialog-close",this.$dialog).removeClass(r):n(".mz-dialog-close",this.$dialog).addClass(r)),void 0!==t.title&&n(".mz-dialog-title",this.$dialog).text(t.title),void 0!==t.content&&n(".mz-dialog-content",this.$dialog).empty().append(t.content),void 0!==t.contentTitle&&n(".mz-dialog-content-title",this.$dialog).text(t.contentTitle),n.isArray(t.buttons))){var i=t.buttons.map(function(t){if(n.isFunction(t.callback))throw new TypeError("Callback must be a function.");return n('<div class="mz-btn '+t.type+'">'+t.text+"</div>").on("click",t.callback.bind(this))});n(".mz-dialog-bottom",this.$dialog).empty().append(i)}var o=!0;return this.emit("beforeShow",function(){o=!1}),o&&(this.$dialog.removeClass(r),this.emit("show")),this},a.prototype.setPosition=function(){var t=n(".mz-dialog",this.$dialog),e=t.outerHeight(),i=t.outerWidth();t.css({marginLeft:-(i/2),marginTop:-(e/2)})},a.prototype.hide=function(){var t=!0;return this.emit("beforeHide",function(){t=!1}),t&&(this.emit("hide"),this.$dialog.addClass(r)),this},a.prototype.destroy=function(){var t=!0;return this.emit("beforeDestroy",function(){t=!1}),t&&(this.emit("destroy"),this.$dialog.remove(),this._init=!1),this},t.exports=a},1,,function(t,e){t.exports=meizuStoreGlobal.underscore},function(t,e){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function o(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function r(t){return void 0===t}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!o(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,i,o,a,c,d;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}if(i=this._events[t],r(i))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),i.apply(this,a)}else if(s(i))for(a=Array.prototype.slice.call(arguments,1),d=i.slice(),o=d.length,c=0;c<o;c++)d[c].apply(this,a);return!0},i.prototype.addListener=function(t,e){var o;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned&&(o=r(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[t].length>o&&(this._events[t].warned=!0,"function"==typeof console.trace)),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){function i(){this.removeListener(t,i),o||(o=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var o=!1;return i.listener=e,this.on(t,i),this},i.prototype.removeListener=function(t,e){var i,o,r,a;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=this._events[t],r=i.length,o=-1,i===e||n(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(i)){for(a=r;a-- >0;)if(i[a]===e||i[a].listener&&i[a].listener===e){o=a;break}if(o<0)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[t],n(i))this.removeListener(t,i);else if(i)for(;i.length;)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e){t.exports='<div class="mz-mask hide">\n  <div class="mz-dialog <%= data.type %> <%= data.className %>">\n    <div class="mz-dialog-header">\n      <div class="mz-dialog-title"><%= data.title %></div>\n      <div class="mz-dialog-close<%= data.hasClose ? \'\' : \'hide\' %>"></div>\n    </div>\n    <div class="mz-dialog-main">\n      <div class="mz-dialog-warp">\n        <% if (data.contentTitle) { %>\n        <div class="mz-dialog-content-title"><%= data.contentTitle %></div>\n        <% } %>\n        <div class="mz-dialog-content"></div>\n      </div>\n    </div>\n    <% if (data.buttons) { %>\n    <div class="mz-dialog-bottom">\n      <% data.buttons.forEach(function(btn) { %>\n      <div class="mz-btn <%= btn.type %>"><%= btn.text %></div>\n      <% }) %>\n    </div>\n    <% } %>\n  </div>\n</div>\n'},function(t,e,i){i(15);var n=i(7),o=i(17)("animation"),s='<div class="mz-loading-mask" />',r='<div class="mz-loading" />',a=['<div class="mz-bounce mz-bounce1"></div>','<div class="mz-bounce mz-bounce2"></div>','<div class="mz-bounce mz-bounce3"></div>'].join(""),c=function(t){var e=n(t||"body");"static"===e.css("position")&&"body"!==e.selector&&e.css("position","relative");var i=!1,c=e.children(".mz-loading-mask");c.length||(c=n(s),i=!0);var d=e.outerHeight(),l=e.outerWidth();if(c.css({width:l,height:d}),!i)return c.show();var u;return u=o?n(r).addClass("spinner").append(a):n(r).addClass("image"),c.append(u).appendTo(e)},d=function(t){var e=n(t||"body"),i=e.children(".mz-loading-mask");return!!i.length&&i.hide()};t.exports={show:c,hide:d}},1,,function(t,e){t.exports=function(t){var e,i=["webkit","Moz","ms","o"],n=[],o=document.documentElement.style,s=function(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})};for(e=0;e<i.length;e++)n.push(s(i[e]+"-"+t));for(n.push(s(t)),e=0;e<n.length;e++)if(n[e]in o)return!0;return!1}},function(t,e,i){i(19);var n=i(7),o=i(21),s=i(12),r=i(28),a=i(14),c=function(){return this._events={},s.apply(this,arguments),this.getImgCount=new r,this.validatedCount=new r,arguments.length>0?this.init.apply(this,arguments):this};c.prototype=new s,c.prototype.constructor=c,c.prototype.init=function(t){var e=this;return this.options=n.extend({},this.defaultOptions,t),this.imgProportion=350/300,this.validated=!1,this.code=null,this.isShowOpener=!1,this.clickPoint=[],this.$element=n('<div class="mz-captcha-input" tabindex="11" hidefocus="true">'+this.texts.hide+"</div>").appendTo(t.selector),280!==this.options.width&&this.$element.css("width",this.options.width),this.$open=n('<div class="mz-captcha-open" tabindex="10" hidefocus="true" />').hide(),this.$tips=n('<div class="mz-captcha-tips">'+this.texts.def+"</div>"),this.$readImgBox=n('<div class="mz-captcha-read" />'),this.$reload=n('<div class="mz-captcha-reload" />'),this.$validate=n('<div class="mz-btn success">验证</div>'),this.$clickImgBox=n('<div class="mz-captcha-click-img" />'),this.$clickBox=n('<div class="mz-captcha-click-box" />'),this.$top=n('<div class="mz-captcha-open-top" />'),this.$center=n('<div class="mz-captcha-open-center" />'),this.$bottom=n('<div class="mz-captcha-open-bottom">'),this.$top.append(this.$tips,this.$readImgBox),this.$center.append(this.$clickImgBox,this.$clickBox),this.$bottom.append(this.$reload,this.$validate),this.$open.append(this.$top,this.$center,this.$bottom).appendTo("body"),this.on("validate",function(t,i){t?e.$element.html(e.texts.validated).addClass("validated"):(e.updateCaptcha(),e.$element.html(e.texts.hide).removeClass("validated")),e.validated=t,e.code=i}),this.on("show",function(){e.isShowOpener=!0,e.validated?e.$element.html(e.texts.validated):e.$element.html(e.texts.unverified)}),this.on("hide",function(){e.isShowOpener=!1,e.validated?e.$element.html(e.texts.validated):e.$element.html(e.texts.hide)}),this.getImgCount.on("end",function(){e.updateCaptcha()}),this.validatedCount.on("end",function(){e.emit("validate",!1)}),this._bind(),this},c.prototype.getValidateState=function(){return this.validated},c.prototype.getValidateCode=function(){return this.code},c.prototype.reset=function(){this.validatedCount.stop(),this.removePoint(),this.emit("validate",!1)},c.prototype._setPosition=function(){var t=this.$element.offset(),e=n(window).scrollTop()+n(window).height(),i=0,o=265;return i=t.top<o||e>o+t.top?t.top+this.$element.height():t.top-o,this.$open.css({top:i,left:t.left,width:this.$element.outerWidth()-2}),this},c.prototype.defaultOptions={imgPrefix:"//store-server.meizu.com/captcha/get",type:6,len:5,sid:null,width:280,timeout:120},c.prototype.texts={def:"请按顺序点击大图中的文字",click:"再次点击图标可取消重选",over:"您以通过验证，无需重复验证",unverified:"安全验证",hide:"点击完成验证",validated:'<i class="mz-captcha-shield"></i>验证通过'},c.prototype._getImg=function(){var t=o.format({query:{type:this.options.type,len:this.options.len,sid:this.options.sid,_t:+new Date}}),e=o.resolve(this.options.imgPrefix,t);return'<img src="'+e+'" class="mz-captcha-img" alt="验证码" />'},c.prototype.updateCaptcha=function(){if(!this.isShow)return!1;var t=this._getImg();this.$readImgBox.html(t),this.$clickImgBox.html(t),this.removePoint(),this.getImgCount.counting&&this.getImgCount.stop(),this.getImgCount.count(this.options.timeout)},c.prototype.show=function(){this._setPosition(),this.$element.addClass("focus"),this.isShow=!0,0===this.getImgCount.options.time&&this.updateCaptcha(),this.$open.show(),this.emit("show")},c.prototype.hide=function(){this.isShow=!1,this.$element.removeClass("focus"),this.$open.hide(),this.emit("hide")},c.prototype.createPoint=function(t,e){if(4==this.clickPoint.length)return!1;var i=this.clickPoint.length+1,o=n('<div class="mz-captcha-click-point" data-index="'+i+'" />');return o.css({top:e-20,left:t-20}),this.clickPoint.push({x:e,y:t,e:o[0]}),this.$tips.html(this.texts.click).removeClass("error"),o},c.prototype.removePoint=function(t){var e=0;if(t){var i=!1;this.clickPoint.forEach(function(o,s){o.e===t&&(e=s,i=!0),i&&n(o.e).remove()})}else this.$clickBox.empty();this.clickPoint.splice(e,4),0===e&&this.$tips.html(this.texts.def)},c.prototype.check=function(){var t=this,e="";this.checking=!0,this.clickPoint.forEach(function(i){var n=i.y*t.imgProportion,o=i.x*t.imgProportion;e+=n+","+o+";"}),n.ajax({url:"//store-server.meizu.com/check_choice_captcha",type:"post",data:{sid:this.options.sid,captcha:e},contentType:"text/plain",beforeSend:a.show.bind(null,t.$open),success:function(e){t.removePoint(),200===e.status?(t.hide(),t.emit("validate",!0,e.randstr),t.validatedCount.count(t.options.timeout)):(t.emit("validate",!1),t.$tips.html(e.error).addClass("error")),t.checking=!1,a.hide(t.$open)},error:function(){t.emit("validate",!1),t.$tips.html("网络错误").addClass("error"),t.checking=!1,a.hide(t.$open)}})},c.prototype._bind=function(){var t=this;this.$reload.on("click",function(){t.updateCaptcha()}),this.$element.on("click",function(){t.isShow?t.hide():t.validated||(t.emit("click"),t.show())}),this.$element.on("blur",function(e){n(document).one("click",function(e){n(e.target).parents(".mz-captcha-open").length&&clearTimeout(t.blurTimeout)}),e.relatedTarget!==t.$open[0]&&(t.blurTimeout=setTimeout(function(){t.emit("blur"),t.hide()},500))}),this.$open.on("blur",function(){t.emit("blur"),t.hide()}),this.$clickBox.on("click",function(e){if(e.target===this){var i=t.createPoint(e.offsetX,e.offsetY);i&&i.appendTo(this),4===t.clickPoint.length&&t.check()}else t.removePoint(e.target)}),this.$validate.on("click",function(){t.clickPoint.length&&!t.validated?t.checking||t.check():t.validated?t.$tips.html(t.texts.over).addClass("error"):t.clickPoint.length||t.$tips.html(t.texts.def).addClass("error")}),n(window).on("resize",function(){t.isShowOpener&&(clearTimeout(t.resizeTimeout),t.resizeTimeout=setTimeout(function(){t._setPosition()},100))})},t.exports=c},1,,function(t,e,i){"use strict";function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(t,e,i){if(t&&d.isObject(t)&&t instanceof n)return t;var o=new n;return o.parse(t,e,i),o}function s(t){return d.isString(t)&&(t=o(t)),t instanceof n?t.format():n.prototype.format.call(t)}function r(t,e){return o(t,!1,!0).resolve(e)}function a(t,e){return t?o(t,!1,!0).resolveObject(e):e}var c=i(22),d=i(24);e.parse=o,e.resolve=r,e.resolveObject=a,e.format=s,e.Url=n;var l=/^([a-z0-9.+-]+:)/i,u=/:[0-9]*$/,p=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["<",">",'"',"`"," ","\r","\n","\t"],v=["{","}","|","\\","^","`"].concat(h),m=["'"].concat(v),f=["%","/","?",";","#"].concat(m),y=["/","?","#"],g=255,x=/^[+a-z0-9A-Z_-]{0,63}$/,b=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,k={javascript:!0,"javascript:":!0},w={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},$=i(25);n.prototype.parse=function(t,e,i){if(!d.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),o=n!==-1&&n<t.indexOf("#")?"?":"#",s=t.split(o),r=/\\/g;s[0]=s[0].replace(r,"/"),t=s.join(o);var a=t;if(a=a.trim(),!i&&1===t.split("#").length){var u=p.exec(a);if(u)return this.path=a,this.href=a,this.pathname=u[1],u[2]?(this.search=u[2],e?this.query=$.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var h=l.exec(a);if(h){h=h[0];var v=h.toLowerCase();this.protocol=v,a=a.substr(h.length)}if(i||h||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var C="//"===a.substr(0,2);!C||h&&w[h]||(a=a.substr(2),this.slashes=!0)}if(!w[h]&&(C||h&&!_[h])){for(var I=-1,T=0;T<y.length;T++){var z=a.indexOf(y[T]);z!==-1&&(I===-1||z<I)&&(I=z)}var A,O;O=I===-1?a.lastIndexOf("@"):a.lastIndexOf("@",I),O!==-1&&(A=a.slice(0,O),a=a.slice(O+1),this.auth=decodeURIComponent(A)),I=-1;for(var T=0;T<f.length;T++){var z=a.indexOf(f[T]);z!==-1&&(I===-1||z<I)&&(I=z)}I===-1&&(I=a.length),this.host=a.slice(0,I),a=a.slice(I),this.parseHost(),this.hostname=this.hostname||"";var S="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!S)for(var D=this.hostname.split(/\./),T=0,j=D.length;T<j;T++){var P=D[T];if(P&&!P.match(x)){for(var E="",M=0,R=P.length;M<R;M++)E+=P.charCodeAt(M)>127?"x":P[M];if(!E.match(x)){var q=D.slice(0,T),F=D.slice(T+1),L=P.match(b);L&&(q.push(L[1]),F.unshift(L[2])),F.length&&(a="/"+F.join(".")+a),this.hostname=q.join(".");break}}}this.hostname.length>g?this.hostname="":this.hostname=this.hostname.toLowerCase(),S||(this.hostname=c.toASCII(this.hostname));var N=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+N,this.href+=this.host,S&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!k[v])for(var T=0,j=m.length;T<j;T++){var U=m[T];if(a.indexOf(U)!==-1){var K=encodeURIComponent(U);K===U&&(K=escape(U)),a=a.split(U).join(K)}}var V=a.indexOf("#");V!==-1&&(this.hash=a.substr(V),a=a.slice(0,V));var Q=a.indexOf("?");if(Q!==-1?(this.search=a.substr(Q),this.query=a.substr(Q+1),e&&(this.query=$.parse(this.query)),a=a.slice(0,Q)):e&&(this.search="",this.query={}),a&&(this.pathname=a),_[v]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var N=this.pathname||"",H=this.search||"";this.path=N+H}return this.href=this.format(),this},n.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",n=this.hash||"",o=!1,s="";this.host?o=t+this.host:this.hostname&&(o=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&d.isObject(this.query)&&Object.keys(this.query).length&&(s=$.stringify(this.query));var r=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||_[e])&&o!==!1?(o="//"+(o||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),r&&"?"!==r.charAt(0)&&(r="?"+r),i=i.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),r=r.replace("#","%23"),e+o+i+r+n},n.prototype.resolve=function(t){return this.resolveObject(o(t,!1,!0)).format()},n.prototype.resolveObject=function(t){if(d.isString(t)){var e=new n;e.parse(t,!1,!0),t=e}for(var i=new n,o=Object.keys(this),s=0;s<o.length;s++){var r=o[s];i[r]=this[r]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),c=0;c<a.length;c++){var l=a[c];"protocol"!==l&&(i[l]=t[l])}return _[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!_[t.protocol]){for(var u=Object.keys(t),p=0;p<u.length;p++){var h=u[p];i[h]=t[h]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||w[t.protocol])i.pathname=t.pathname;else{for(var v=(t.pathname||"").split("/");v.length&&!(t.host=v.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==v[0]&&v.unshift(""),v.length<2&&v.unshift(""),i.pathname=v.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var m=i.pathname||"",f=i.search||"";i.path=m+f}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var y=i.pathname&&"/"===i.pathname.charAt(0),g=t.host||t.pathname&&"/"===t.pathname.charAt(0),x=g||y||i.host&&t.pathname,b=x,k=i.pathname&&i.pathname.split("/")||[],v=t.pathname&&t.pathname.split("/")||[],$=i.protocol&&!_[i.protocol];if($&&(i.hostname="",i.port=null,i.host&&(""===k[0]?k[0]=i.host:k.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===v[0]?v[0]=t.host:v.unshift(t.host)),t.host=null),x=x&&(""===v[0]||""===k[0])),g)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,k=v;else if(v.length)k||(k=[]),k.pop(),k=k.concat(v),i.search=t.search,i.query=t.query;else if(!d.isNullOrUndefined(t.search)){if($){i.hostname=i.host=k.shift();var C=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@");C&&(i.auth=C.shift(),i.host=i.hostname=C.shift())}return i.search=t.search,i.query=t.query,d.isNull(i.pathname)&&d.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!k.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var I=k.slice(-1)[0],T=(i.host||t.host||k.length>1)&&("."===I||".."===I)||""===I,z=0,A=k.length;A>=0;A--)I=k[A],"."===I?k.splice(A,1):".."===I?(k.splice(A,1),z++):z&&(k.splice(A,1),z--);if(!x&&!b)for(;z--;z)k.unshift("..");!x||""===k[0]||k[0]&&"/"===k[0].charAt(0)||k.unshift(""),T&&"/"!==k.join("/").substr(-1)&&k.push("");var O=""===k[0]||k[0]&&"/"===k[0].charAt(0);if($){i.hostname=i.host=O?"":k.length?k.shift():"";var C=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@");C&&(i.auth=C.shift(),i.host=i.hostname=C.shift())}return x=x||i.host&&k.length,x&&!O&&k.unshift(""),k.length?i.pathname=k.join("/"):(i.pathname=null,i.path=null),d.isNull(i.pathname)&&d.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},n.prototype.parseHost=function(){var t=this.host,e=u.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,i){var n;(function(t,o){!function(s){function r(t){throw RangeError(D[t])}function a(t,e){for(var i=t.length,n=[];i--;)n[i]=e(t[i]);return n}function c(t,e){var i=t.split("@"),n="";i.length>1&&(n=i[0]+"@",t=i[1]),t=t.replace(S,".");var o=t.split("."),s=a(o,e).join(".");return n+s}function d(t){for(var e,i,n=[],o=0,s=t.length;o<s;)e=t.charCodeAt(o++),e>=55296&&e<=56319&&o<s?(i=t.charCodeAt(o++),56320==(64512&i)?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),o--)):n.push(e);return n}function l(t){return a(t,function(t){var e="";return t>65535&&(t-=65536,e+=E(t>>>10&1023|55296),t=56320|1023&t),e+=E(t)}).join("")}function u(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:k}function p(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function h(t,e,i){var n=0;for(t=i?P(t/C):t>>1,t+=P(t/e);t>j*_>>1;n+=k)t=P(t/j);return P(n+(j+1)*t/(t+$))}function v(t){var e,i,n,o,s,a,c,d,p,v,m=[],f=t.length,y=0,g=T,x=I;for(i=t.lastIndexOf(z),i<0&&(i=0),n=0;n<i;++n)t.charCodeAt(n)>=128&&r("not-basic"),m.push(t.charCodeAt(n));for(o=i>0?i+1:0;o<f;){for(s=y,a=1,c=k;o>=f&&r("invalid-input"),d=u(t.charCodeAt(o++)),(d>=k||d>P((b-y)/a))&&r("overflow"),y+=d*a,p=c<=x?w:c>=x+_?_:c-x,!(d<p);c+=k)v=k-p,a>P(b/v)&&r("overflow"),a*=v;e=m.length+1,x=h(y-s,e,0==s),P(y/e)>b-g&&r("overflow"),g+=P(y/e),y%=e,m.splice(y++,0,g)}return l(m)}function m(t){var e,i,n,o,s,a,c,l,u,v,m,f,y,g,x,$=[];for(t=d(t),f=t.length,e=T,i=0,s=I,a=0;a<f;++a)m=t[a],m<128&&$.push(E(m));for(n=o=$.length,o&&$.push(z);n<f;){for(c=b,a=0;a<f;++a)m=t[a],m>=e&&m<c&&(c=m);for(y=n+1,c-e>P((b-i)/y)&&r("overflow"),i+=(c-e)*y,e=c,a=0;a<f;++a)if(m=t[a],m<e&&++i>b&&r("overflow"),m==e){for(l=i,u=k;v=u<=s?w:u>=s+_?_:u-s,!(l<v);u+=k)x=l-v,g=k-v,$.push(E(p(v+x%g,0))),l=P(x/g);$.push(E(p(l,0))),s=h(i,y,n==o),i=0,++n}++i,++e}return $.join("")}function f(t){return c(t,function(t){return A.test(t)?v(t.slice(4).toLowerCase()):t})}function y(t){return c(t,function(t){return O.test(t)?"xn--"+m(t):t})}var g=("object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof o&&o);g.global!==g&&g.window!==g&&g.self!==g||(s=g);var x,b=2147483647,k=36,w=1,_=26,$=38,C=700,I=72,T=128,z="-",A=/^xn--/,O=/[^\x20-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,D={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},j=k-w,P=Math.floor,E=String.fromCharCode;x={version:"1.3.2",ucs2:{decode:d,encode:l},decode:v,encode:m,toASCII:y,toUnicode:f},n=function(){return x}.call(e,i,e,t),!(void 0!==n&&(t.exports=n))}(this)}).call(e,i(23)(t),function(){return this}())},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,i){"use strict";e.decode=e.parse=i(26),e.encode=e.stringify=i(27)},function(t,e){"use strict";function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,o){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var r=/\+/g;t=t.split(e);var a=1e3;o&&"number"==typeof o.maxKeys&&(a=o.maxKeys);var c=t.length;a>0&&c>a&&(c=a);for(var d=0;d<c;++d){var l,u,p,h,v=t[d].replace(r,"%20"),m=v.indexOf(n);m>=0?(l=v.substr(0,m),u=v.substr(m+1)):(l=v,u=""),p=decodeURIComponent(l),h=decodeURIComponent(u),i(s,p)?Array.isArray(s[p])?s[p].push(h):s[p]=[s[p],h]:s[p]=h}return s}},function(t,e){"use strict";var i=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,o){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map(function(o){var s=encodeURIComponent(i(o))+n;return Array.isArray(t[o])?t[o].map(function(t){return s+encodeURIComponent(i(t))}).join(e):s+encodeURIComponent(i(t[o]))}).join(e):o?encodeURIComponent(i(o))+n+encodeURIComponent(i(t)):""}},function(t,e,i){var n=i(7),o=i(12),s=function(){return this._events={},o.apply(this,arguments),this.init.apply(this,arguments)};s.prototype=new o,s.prototype.constructor=s,s.prototype.defaultOptions={time:0,step:1,timeStep:1e3},s.prototype.init=function(t){if(this._isInit)return this;var e=this;return this._isInit=!0,this._cumulative=0,this.options=n.extend({},this.defaultOptions,t),this.on("count",function(t){e.options.time=t}),0!==this.options.time&&this.count(this.options.time),this},s.prototype._correct=function(t){if(!this._correctTime)return this._correctTime=+new Date,t;var e=+new Date,i=this.options.timeStep,n=e-i;if(this._cumulative+=n-this._correctTime,this._cumulative>=i){var o=Math.floor(this._cumulative/i);this._cumulative=this._cumulative%i,t-=o*this.options.step}return this._correctTime=e,t},s.prototype.count=function(t,e){if(!e&&this._counting)return!1;var i=this;return t=this._correct(t),this._counting=setTimeout(function(){var e=t-i.options.step;e=e>=0?e:0,i.emit("count",e,t),e>0?i.count(e,!0):(delete i.counting,i.emit("end"))},this.options.timeStep),this},s.prototype.pause=function(){return clearTimeout(this._counting),delete this._counting,this},s.prototype.proceed=function(){return this.count(this.options.time),this},s.prototype.stop=function(){return clearTimeout(this._counting),delete this._counting,delete this._correctTime,this._cumulative=0,this},s.prototype.start=function(t){return this.options=n.extend({},this.options,t),this.count(this.options.time),this},t.exports=s},function(t,e,i){var n=i(7),o=i(12),s=function(){return this._events={},o.apply(this,arguments),this.init.apply(this,arguments)};s.prototype=new o,s.prototype.constructor=s,s.prototype.init=function(t){return this.options=n.extend({},this.defaultOptions,t),this},s.prototype.defaultOptions={url:"/independent"},s.prototype.get=function(t,e){
return!(!t||!n.isFunction(t))&&void n.ajax({url:this.options.url,type:"get",cache:!1,async:!e,success:function(e,i,n){if(200==e.code){var o=n.getResponseHeader("X-CSRF-TOKEN");t(null,o,n)}else t(e.error)},error:function(){t("网络错误")}})},s.prototype.async=function(){var t="";return this.get(function(e,i){if(e)throw Error(e);t=i},!0),t},t.exports=function(t){return new s(t)}},function(t,e,i){i(31);var n=i(7),o=i(11),s=i(29)(),r=i(14),a=i(33),c=i(8),d=i(12),l=i(37),u="tips",p="data-tips",h=[],v=!1,m=0,f=null,y=null,g=null,x=null,b=!0,k=174,w={name:/^[\u4E00-\u9FA5A-Za-z0-9_\-\(\)\（\）\·]+$/,phone:/^[1][34578][0-9]{9}$/,detail:/^[\u4E00-\u9FA5A-Za-z0-9_\-\(\)\（\）]+$/},_=n("#addressList"),$=n("#addressAdd"),C=n("#addressModule"),I=n("#orderAddressHasOldTips"),T=n("#orderAddressMore"),z=n(l),A=new c({title:"提示",type:"tips"}),O=new d,S=new c({className:"address-adder",content:z,buttons:[{type:"success",text:"确认",callback:function(){var t=N();if(!t)return!1;var e=B();if(!e)return!1;var i=K();if(!i)return!1;var n=U();return!!n&&void H(t,e,i,n)}},{type:"cancel",text:"取消",callback:function(){this.hide()}}]}),D=i(38),j=o.template(i(39),{variable:"data"}),P=new a({selector:n(".address-adder-select",z),showOther:!0,province:{placeholder:"省份/直辖市"},other:{errorTips:"其他地址不能包含特殊字符",placeholder:"请输入其他街道名称"}}),E=function(){v||(_.find(".order-address-checkbox.add").remove(),m>3&&m<10&&b?n(D).insertAfter(_.children().eq(2)):m<10&&n(D).appendTo(_),b?_.css({height:k}):_.css({height:Math.ceil((m+1)/4)*k}),b&&m>3&&T.css("display","inline-block"))},M=function(t){n(this).addClass("checked").siblings().removeClass("checked"),f=t.id,O.emit("selectAddress",n.extend({},t))},R=function(t,e){var i=n(e.delegateTarget);return n.ajax({url:"/customer_address/remove_submit.html",type:"get",data:{id:t.id},dataType:"json",timeout:1e4,beforeSend:r.show.bind(this,C),success:function(e){200===e.code?(m--,i.remove(),f===t.id&&(f=null),E()):A.show({content:e.message}),r.hide(C)},error:function(){r.hide(C),A.show({content:"网络错误"})}}),!1},q=function(t,e){x=t,g=n(e.delegateTarget),y=t.id,V(t),P.setData({province:{id:t.provinceId,text:t.province},city:{id:t.cityId,text:t.city},area:{id:t.areaId,text:t.area},street:{id:t.townId,text:0==t.townId?"其他":t.town,zipCode:t.zipCode},other:0==t.townId?t.town:""},!!t.isOld),t&&0==t.townId&&n(".address-adder-other",z).show(),S.show({title:"修改地址"}).setPosition()},F=function(t){return t.isOld&&I.css("display","inline-block"),t.isSelected=t.id==f||void 0!==t.useAppointAddr,n(j(t)).on("click",function(){n(this).hasClass("disabled")||n(this).hasClass("checked")||M.call(this,t)}).on("click",".order-address-checkbox-delete",R.bind(this,t)).on("click",".order-address-checkbox-edit,.order-address-checkbox-perfect",q.bind(this,t))},L=function(t){var e;t.useAppointAddr?(f=t.activeAddressId,m=1,v=!0,t.appointAddress.useAppointAddr=t.useAppointAddr,e=F(t.appointAddress),h.push(t.appointAddress)):(f=t.activeAddressId?t.activeAddressId:null,m=t.addressList.length,t.addressList.sort(function(e){return e.id===t.activeAddressId?-1:1}).sort(function(t,e){return t.isOld-e.isOld}),e=n.map(t.addressList,F.bind(this)),h=t.addressList,$.show()),_.append(e),E()},N=function(){var t=n(".address-adder-name",z),e=n.trim(t.val()),i=t.parent();return e.length?e.length>15?(i.addClass(u).attr(p,"收件人姓名过长，请重新输入！"),!1):w.name.test(e)?(i.removeClass(u).attr(p," "),e):(i.addClass(u).attr(p,"请输入正确的收件人姓名！"),!1):(i.addClass(u).attr(p,"请输入收件人姓名！"),!1)},B=function(){var t=n(".address-adder-phone",z),e=n.trim(t.val()),i=t.parent();return e.length?w.phone.test(e)?(i.removeClass(u).attr(p," "),e):(i.addClass(u).attr(p,"请输入正确的手机号码！"),!1):(i.addClass(u).attr(p,"请输入手机号码！"),!1)},U=function(){var t=n(".address-adder-detail",z),e=n.trim(t.val()),i=t.parent();return!e.length||e.length<4?(i.addClass(u).attr(p,"请输入详细地址！"),!1):e.length>50?(i.addClass(u).attr(p,"详细地址过长，请重新输入！"),!1):w.detail.test(e)?(i.removeClass(u).attr(p," "),e):(i.addClass(u).attr(p,"请输入正确的详细地址！"),!1)},K=function(){var t=P.getData(),e=n(".address-adder-select",z);return t.province.id&&t.city.id&&t.area.id&&""!==t.street.id?(e.removeClass(u).attr(p," "),(0!==t.street.id||""!==t.other)&&t):(e.addClass(u).attr(p,"请选择地址"),!1)},V=function(t){n(".address-adder-other",z).hide(),n(".address-adder-name",z).val(t.receiver).parent().removeClass(u),n(".address-adder-phone",z).val(t.telNumber).parent().removeClass(u),n(".address-adder-detail",z).val(t.address).parent().removeClass(u)},Q=function(){P.on("change",function(t,e,i){"street"===t&&0===i||"other"===t?n(".address-adder-other",z).show():n(".address-adder-other",z).hide(),S.setPosition()}),_.on("click",".order-address-checkbox.add",function(){V({receiver:"",telNumber:"",address:""}),P.clear(),S.show({title:"添加新地址"}).setPosition()}),T.on("click",function(){b&&(b=!1),E(),n(this).remove()}),n(".address-adder-name",z).on("blur",N),n(".address-adder-phone",z).on("blur",B),n(".address-adder-detail",z).on("blur",U)},H=function(t,e,i,o){if(m>=10&&!y)return void A.show({content:"最多不能超过10个地址"});var a=i.province.text+i.city.text+(i.area.text==i.street.text||0==i.street.id?i.area.text:i.area.text+i.street.text)+i.other+o,c=i.street.zipCode||i.area.zipCode||i.city.zipCode||i.province.zipCode||0,d={provinceId:i.province.id,province:i.province.text,cityId:i.city.id,city:i.city.text,areaId:i.area.id,area:i.area.text,townId:i.street.id,town:0==i.street.id?i.other:i.street.text,zipCode:c,completeAddress:a,address:o,id:y||0,receiver:t,telNumber:e};s.get(function(t,e){return t?void A.show({content:t}):void n.ajax({url:"/customer_address/modify_submit.html",type:"post",data:d,dataType:"json",headers:{"X-CSRF-TOKEN":e},timeout:1e4,beforeSend:r.show.bind(null,C),success:function(t){if(200===t.code){if(y){var e=n(F(d)).replaceAll(g);n.extend(x,d),M.call(e,d)}else m++,d.id=t.data,h.push(d),n(F(d)).appendTo(_).click(),m>3&&!y&&(b=!1,T.remove()),E();x=null,g=null,y=null,S.hide()}else A.show({content:t.message||t.msg});r.hide(C)},error:function(){r.hide(C),A.show({content:"网络错误"})}})})},X=function(){return f},Z=function(t){void 0===t&&(t=f);for(var e=null,i=0;i<h.length;i++)t===h[i].id&&(e=h[i]);return e},J=function(t){L(t),Q()};t.exports={init:J,event:O,$addressModule:C,getActiveAddressId:X,getAddressObjectById:Z}},1,,function(t,e,i){i(34);var n=i(7),o=i(12),s=i(35),r=function(){return this._events={},o.apply(this,arguments),this.data={province:{id:"",text:"",zipCode:""},city:{id:"",text:"",zipCode:""},area:{id:"",text:"",zipCode:""},street:{id:"",text:"",zipCode:""},other:""},arguments.length>0?this.init.apply(this,arguments):this};r.prototype=new o,r.prototype.constructor=r,r.prototype.levelArray=["province","city","area","street"],r.prototype.cityData={province:{index:0,data:{},json:{}},city:{index:1,data:{},json:{}},area:{index:2,data:{},json:{}},street:{index:3,data:{},json:{}}},r.prototype.defaultOptions={alert:function(t){alert(t)},listValueKey:"code",listTextKey:"name",selector:"",showOther:!1,province:{placeholder:"省/直辖市",name:""},city:{placeholder:"城市",name:""},area:{placeholder:"区/县",name:""},street:{placeholder:"乡镇/街道",name:""},other:{maxlength:10,errorTips:"内容有误",placeholder:"其他",name:""}},r.prototype.init=function(t){this.options=n.extend(!0,{},this.defaultOptions,t);var e=this,i="<div />";return this.DOMS={province:n(i),city:n(i),area:n(i),street:n(i)},this.$otherInput=n(i).addClass("mz-address-other mz-input-warp").append('<input type="text" class="mz-input mz-address-input" placeholder="'+this.options.other.placeholder+'" maxlength="'+this.options.other.maxlength+'" />').hide().attr("name",this.options.other.name),this.$element=n(t.selector).append(this.DOMS.province,this.DOMS.city,this.DOMS.area,this.DOMS.street,this.$otherInput).addClass("mz-address"),n.each(this.DOMS,function(t){e.DOMS[t]=new s({selector:this,placeholder:e.options[t].placeholder,name:e.options[t].name,listValueKey:e.options.listValueKey,listTextKey:e.options.listTextKey}).on("select",e._handleChange.bind(e,t)).on("click",e._handleClick.bind(e,t))}),this.otherInputReg=/^[\u4E00-\u9FA5A-Za-z0-9_\-\(\)\（\）]+$/,n(".mz-input",this.$otherInput).on("input propertychange",function(){var t=n(this).val();e.otherInputReg.test(t)?(e.data.other=t,n(this).parent().removeClass("tips").removeAttr("data-tips")):(e.data.other="",n(this).parent().addClass("tips").attr("data-tips",e.options.other.errorTips)),e.emit("change","other",e.data.other,e.data.other,e.getData())}),this},r.prototype.clear=function(t){t=t||0;for(var e=t;e<this.levelArray.length;e++){var i=this.levelArray[e];this.DOMS[i].clear(),this.data[i]={id:"",text:"",zipCode:""}}return this.data.other="",this.$otherInput.removeClass("tips").removeAttr("data-tips"),this.$otherInput.hide().children().val(""),this},r.prototype.setData=function(t,e,i){if(e){var o=this;this._getData("province",0,function(e){this.DOMS.province.setDownmenu(e).setData(t.province.text),this.data.province={id:o.DOMS.province.options.value,text:o.DOMS.province.options.text,zipCode:""},this._handleChange("province",o.DOMS.province.options.text,o.DOMS.province.options.value),i&&n.isFunction(i)&&i()})}else n.each(t,function(t,e){"other"!=t&&this.DOMS[t].setData(e.text,e.id)}.bind(this)),this.data=n.extend(!0,{},this.data,t),this.$otherInput.removeClass("tips").removeAttr("data-tips"),0==this.data.street.id&&this.options.showOther?this.$otherInput.show().children().val(this.data.other):this.$otherInput.hide(),i&&n.isFunction(i)&&i();return this},r.prototype.getData=function(){return n.extend(!0,{},this.data)},r.prototype._handleClick=function(t){var e=Array.prototype.slice.call(arguments);e.push(this.getData()),this.emit.apply(this,["click"].concat(e));var i=this.cityData[t].index,n=this.levelArray[i-1]||"province",o="province"==t?0:this.data[n].id;this.DOMS[t].$ul||!o&&0!=i||this._getData(t,o,function(e){this.DOMS[t].setDownmenu(e)})},r.prototype._extendCityJson=function(t,e){var i=this;n.each(e,function(e,n){i.cityData[t].json[n[i.options.listValueKey]]=n})},r.prototype._handleChange=function(t,e,i){var n=this.cityData[t].index;if(e&&(this.data[t].id=i,this.data[t].text=e,this.data[t].zipCode=this.cityData[t].json[i].zipCode||"",this.clear(n+1),this.emit("change",t,e,i,this.getData())),n==this.levelArray.length-1)return void(0==i&&this.options.showOther&&this.$otherInput.show());var o=this.levelArray[n+1];this._getData(o,i,function(t){this.DOMS[o].setDownmenu(t),1==t.length&&(this.DOMS[o].setData(t[0][this.options.listTextKey],t[0][this.options.listValueKey]),this._handleChange(o,t[0][this.options.listTextKey],t[0][this.options.listValueKey]))})},r.prototype._getData=function(t,e,i){return e=e||0,this.cityData[t].data[e]?void setTimeout(function(){i.call(this,this.cityData[t].data[e]),this.emit("data",t,this.cityData[t].data[e])}.bind(this)):void n.ajax({url:"//area.meizu.com/area/child/query/"+e,dataType:"jsonp",success:function(n){n.success?(this.cityData[t].data[e]=n.data,this._extendCityJson(t,n.data),this.emit("data",t,n.data),i.call(this,n.data)):this.options.alert(n.errorMsg)}.bind(this),error:function(){this.options.alert("服务器忙")}.bind(this)})},r.prototype.remove=function(){var t=this;this.clear(),n.each(this.DOMS,function(e,i){i.remove(),t.DOMS[e]=null})},t.exports=r},1,function(t,e,i){i(36);var n=i(7),o=i(12),s=function(){return this._events={},o.apply(this,arguments),arguments.length>0?this.init.apply(this,arguments):this};s.prototype=new o,s.prototype.constructor=s,s.prototype.defaultOptions={placeholder:"",select:"",text:"",value:"",name:"",listTextKey:"",listValueKey:"",data:null},s.prototype.init=function(t){return this.options=t=n.extend({},this.defaultOptions,t),this.$element=n(t.selector).addClass("mz-selectmenu"),this.$show=n('<input type="text" readonly="readonly" tabindex="-1" class="mz-downmenu-input" />').appendTo(this.$element).attr("placeholder",t.placeholder).val(t.text),this.$value=n('<input type="hidden" tabindex="-1" />').appendTo(this.$element).val(t.value).attr("name",t.name),this.$downmenu=n('<div class="mz-downmenu" />').appendTo("body"),this.setDownmenu(t.data),this.bind(),this},s.prototype.bind=function(){var t=this;this.$show.on("click",function(e){var i=n.extend({},t.options);t.emit("click",i,e),t._setPosition(),t.$downmenu.slideDown(50,function(){t.emit("show",i,e)})}),this.$show.on("blur",function(){t.beforeClose=setTimeout(function(e){var i=n.extend({},t.options);t.$downmenu.slideUp(50,function(){t.emit("blur",i,e)})},200)}),this.$downmenu.on("scroll",function(){clearTimeout(t.beforeClose)}),n(window).on("scroll",function(){t.$element.is(":visible")&&t._setPosition()})},s.prototype._setPosition=function(){var t=this.$element.offset();this.$downmenu.css({top:t.top+this.$element.height(),left:t.left,width:this.$element.outerWidth()-2})},s.prototype.setData=function(t,e){if(void 0==t&&void 0==e)return this;if(void 0==t&&e){if(!this.listObject)return this;n.each(this.listObject,function(i,n){var o=this.options.listValueKey?n[this.options.listValueKey]:n;o==e&&(t=this.options.listTextKey?n[this.options.listTextKey]:i)}.bind(this))}else if(void 0==e&&t){if(!this.listObject)return this;n.each(this.listObject,function(i,n){var o=this.options.listTextKey?n[this.options.listTextKey]:i;o==t&&(e=this.options.listValueKey?n[this.options.listValueKey]:n)}.bind(this))}return this.$show.val(t),this.$value.val(e),this.options.value=e,this.options.text=t,this},s.prototype.getData=function(){var t=this;return{text:t.options.text,value:t.options.value}},s.prototype.setDownmenu=function(t){if(t){var e=this;return this.listObject=t,this.$ul=n('<ul class="mz-downmenu-list" />'),n.each(t,function(t,i){var o=this;this._text=e.options.listTextKey?this[e.options.listTextKey]:t,this._value=e.options.listValueKey?this[e.options.listValueKey]:i,n('<li class="mz-downmenu-item" />').appendTo(e.$ul).text(this._text).on("click",function(i){var s=n.extend({},e.options);e.emit("select",o._text,o._value,s,i,t),o._text!=e.options.text&&(e.$show.val(o._text),e.$value.val(o._value),e.options.value=o._value,e.options.text=o._text,e.emit("change",o._text,o._value,s,i,t)),e.$downmenu.slideUp(50)})}),this.$downmenu.html(this.$ul),this.emit("setDownmenu"),this}},s.prototype.clear=function(){return this.$value.val(""),this.$show.val(""),this.$downmenu.empty(),this.options.value="",this.options.text="",delete this.$ul,this},s.prototype.remove=function(){this.clear(),this.$show.remove(),this.$value.remove(),this.$downmenu.remove()},t.exports=s},1,function(t,e){t.exports='<div class="address-adder-content">\n  <div class="address-adder-row clearfix">\n    <div class="address-adder-title">收货人姓名<span class="address-adder-must">*</span></div>\n    <div class="mz-input-warp"><input type="text" class="mz-input address-adder-name" placeholder="姓名长度不超过15个汉字" value="" maxlength="15" /></div>\n    <div class="address-adder-title">收货人手机号<span class="address-adder-must">*</span></div>\n    <div class="mz-input-warp"><input type="text" class="mz-input address-adder-phone" placeholder="请输入11位手机号" value="" maxlength="11" /></div>\n  </div>\n  <div class="address-adder-row clearfix">\n    <div class="address-adder-title">收货人地址<span class="address-adder-must">*</span></div>\n    <div class="mz-input-warp address-adder-select"></div>\n  </div>\n  <div class="address-adder-row clearfix address-adder-other">\n    <div class="address-adder-title">其他</div>\n  </div>\n  <div class="address-adder-row clearfix">\n    <div class="address-adder-title">详细地址<span class="address-adder-must">*</span></div>\n    <div class="mz-input-warp">\n      <input type="text" class="mz-input address-adder-detail" placeholder="请输入4-50个汉字的详细地址，例如路名、门牌号" value="" maxlength="50" minlength="4" />\n    </div>\n  </div>\n</div>\n'},function(t,e){t.exports='<li class="order-address-checkbox add">\n  <div class="order-address-add-icon"></div>\n  <div class="order-address-add-text">添加新地址</div>\n</li>\n'},function(t,e){t.exports='<li class="order-address-checkbox <%= data.isOld ? \'disabled\' : data.isSelected ? \'checked\' : \'\' %>" data-mdesc="收货人信息" data-mtype="store_se_adr" >\n<div class="order-address-checkbox-top">\n  <div class="order-address-checkbox-name" title="<%= data.receiver %>"><%= data.receiver %></div>\n  <div class="order-address-checkbox-phone"><%= data.telNumber %></div>\n</div>\n<div class="order-address-checkbox-content"><%= data.completeAddress %></div>\n<div class="order-address-checkbox-checked">\n  <div class="order-address-checkbox-tick"></div>\n</div>\n<% if (!data.useAppointAddr) { %>\n<div class="order-address-checkbox-ctrl">\n  <div class="order-address-checkbox-delete"></div>\n  <div class="order-address-checkbox-edit"></div>\n  </div>\n<% } %>\n<% if (data.isOld) { %>\n<div class="order-address-checkbox-tips">\n  因配送地址库升级，提交订单前，请务必完善地址信息，让您享受更好的配送服务。\n  <div class="order-address-checkbox-row">\n    <i class="order-address-checkbox-perfect"></i>\n  </div>\n</div>\n<% } %>\n</li>\n'},function(t,e,i){i(41);var n=i(7),o=i(11),s=i(35),r=i(8),a=i(28),c=i(43),d=i(44),l=0,u={},p=[],h=!1,v=null,m=null,f="data-tips",y="tips",g=/^[\u4E00-\u9FA5A-Za-z0-9_\-\(\)\（\）]+$/,x=n("#orderProductList"),b=[{text:"企业",value:"01",placeholder:"请输入企业抬头全称"},{text:"机关事业单位",value:"02",placeholder:"请输入发票抬头全称"},{text:"个人",value:"03",placeholder:"默认收货人姓名"},{text:"其他",value:"04",placeholder:"请输入发票抬头全称"}],k=o.template(i(45)),w=o.template(i(46),{variable:"data"}),_=o.template(i(47),{variable:"skuInfo"}),$=o.template(i(48),{variable:"data"}),C=o.template(i(49),{variable:"data"}),I=function(t){if(0!==t.fastArrivalStatus){var e=c(new Date(t.payDate),"hh:mm");return k({text:1===t.fastArrivalStatus?"当日达":"次日达",beforeTime:"00:00"===e?"24:00":e,day:1===t.fastArrivalStatus?"今天":"明天",date:c(new Date(t.arrivalDate),"MM月dd日")})}return'<div class="order-product-arrival" />'},T=function(t,e,i){return i.skus={},t.map(function(t,o){t.reduceName={0:"套餐优惠",1:"限时折扣优惠"},t.productIndex=o,t.merchantExpressFee=e;var s={$selector:n(_(t)),number:t.number,skuId:t.skuId,index:o};if(t.packageId){s.packageId=t.packageId;var r=t.skuInfoBoList.map(function(t){return t.skuId});s.packageList=r.join(","),s.uniqueId=t.skuId+"-"+s.packageId+"-"+r.join("-")}else s.uniqueId=t.skuId;return i.skus[s.uniqueId]=s,t.activeTimeEnd&&(s.countdown=new a({step:1e3}).on("end",function(){p.push('"'+t.itemName+" "+t.cspuDesc+(t.packageId?" "+t.packageName:"")+'"')}).on("count",function(t){n(".order-product-countdown",s.$selector).text("限时特惠：剩余"+d(t).string)}).count(t.activeTimeEnd-l)),s.$selector})},z=function(t){v||(v=new r({title:"发票信息",className:"order-invoice-dialog"}),v.on("beforeSuccess",function(t){var e=this._data._select.getData().value,i={invoiceOrg:e,invoiceIdentifySn:"",invoiceBank:"",invoiceBankAccount:"",invoiceTitle:"03"===e&&2===this._data.invoiceType?"默认为收货人姓名":n.trim(this._data._$invoiceName.val())};if(""===i.invoiceTitle)return this._data._$invoiceName.parent().attr(f,"发票抬头不能为空").addClass(y),t(),!1;if(!g.test(i.invoiceTitle))return this._data._$invoiceName.parent().attr(f,"请输入正确的发票抬头").addClass(y),t(),!1;if(this._data._$invoiceName.parent().removeClass(y),"01"===i.invoiceOrg){if(i.invoiceIdentifySn=this._data._$invoiceIdentifySn.val(),i.invoiceBank=this._data._$invoiceBank.val(),i.invoiceBankAccount=this._data._$invoiceBankAccount.val(),!i.invoiceIdentifySn)return this._data._$invoiceIdentifySn.parent().attr(f,"纳税人识别号不能为空").addClass(y),t(),!1;if(!g.test(i.invoiceIdentifySn))return this._data._$invoiceIdentifySn.parent().attr(f,"请输入正确的纳税人识别号").addClass(y),t(),!1;if(this._data._$invoiceIdentifySn.parent().removeClass(y),""!==i.invoiceBank&&!g.test(i.invoiceBank))return this._data._$invoiceBank.parent().attr(f,"请输入正确的开户行").addClass(y),t(),!1;if(this._data._$invoiceBank.parent().removeClass(y),""!==i.invoiceBankAccount&&!g.test(i.invoiceBankAccount))return this._data._$invoiceBankAccount.parent().attr(f,"请输入正确的开户行账号").addClass(y),t(),!1;this._data._$invoiceBankAccount.parent().removeClass(y),this._data._$invoiceEnterpriseLine||(this._data._$invoiceEnterpriseLine=n("<p />"));var o=C(i);this._data._$invoiceEnterpriseLine.text(o),n(".order-product-invoice-info",this._data.$selector).append(this._data._$invoiceEnterpriseLine)}else this._data._$invoiceEnterpriseLine&&this._data._$invoiceEnterpriseLine.remove();n(".order-product-invoice-title",this._data.$selector).text(i.invoiceTitle),n.extend(this._data,i)}),v.on("hide",function(){this._data._$invoiceContent.detach()})),t._$invoiceContent||(t._$invoiceContent=n($(t)),t._$invoiceName=n("[name=name]",t._$invoiceContent),t._$invoiceIdentifySn=n("[name=identifySn]",t._$invoiceContent),t._$invoiceBank=n("[name=bank]",t._$invoiceContent),t._$invoiceBankAccount=n("[name=bankAccount]",t._$invoiceContent),t._$invoiceEnterprise=n(".order-invoice-dialog-enterprise",t._$invoiceContent),t._select=new s({selector:n(".order-invoice-dialog-type",t._$invoiceContent),text:"个人",value:"03",listTextKey:"text",listValueKey:"value",data:b}).on("change",function(e,i,n,o,s){t._$invoiceName.attr({placeholder:b[s].placeholder,disabled:"03"===i&&2===t.invoiceType}),"03"===i&&2===t.invoiceType&&t._$invoiceName.val(""),"01"===i?t._$invoiceEnterprise.show():t._$invoiceEnterprise.hide(),v.setPosition()})),v._data=t,v.show({content:t._$invoiceContent}).setPosition()},A=function(t){return t.map(function(t,e){var i=u[t.merchantId]={index:e,$selector:n(w(t)),invoiceType:t.merchantId>1e4?0:2,invoiceOrg:"03"};return 2!==i.invoiceType&&(i.invoiceTitle="个人",n(".order-product-invoice-checkbox",i.$selector).on("click",function(){i.invoiceType?(i.invoiceType=0,n(".order-product-invoice-info",i.$selector).addClass("hide")):(i.invoiceType=1,z(i),n(".order-product-invoice-info",i.$selector).removeClass("hide"))})),n(".order-product-invoice-edit",i.$selector).on("click",function(){z(i)}),n(".order-product-remark-input",i.$selector).on("input propertychange",function(){i.remark=n(this).val()}),n("tbody",i.$selector).append(T(t.skuInfo,t.merchantExpressFee,i)),t.supportFastArrival&&(h=!0,i.$arrival=n(I(t.fastArrival)),n("tbody .order-product-table-express",i.$selector).append(i.$arrival)),i.$selector})},O=function(){x.on("click",".order-product-invoice-icon",function(){m||(m=new r({type:"msg",title:"电子发票详细介绍",content:i(50),buttons:[]})),m.show()})},S=function(){return p},D=function(){return u},j=function(){return h},P=function(t,e){l=e,x.html(A(t)),O()};t.exports={init:P,setArrival:I,getCountEndProd:S,getSupportFastArrival:j,getProductPointer:D}},1,,function(t,e){t.exports=function(t,e){e=e||"yyyy-MM-dd hh:mm:ss";var i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in i)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[n]:("00"+i[n]).substr((""+i[n]).length)));return e}},function(t,e){t.exports=function(t){var e=parseInt(t/864e5,10),i=parseInt((t-864e5*e)/36e5,10),n=parseInt((t-864e5*e-36e5*i)/6e4,10),o=parseInt((t-864e5*e-36e5*i-6e4*n)/1e3,10);e=e>0?e<10?"0"+e:e:0,i=i>0?i<10?"0"+i:i:0,n=n>0?n<10?"0"+n:n:0,o=o>0?o<10?"0"+o:o:0;var s=e>0?" "+e+"天"+i+"时"+n+"分"+o+"秒 ":i>0?" "+i+"时"+n+"分"+o+"秒 ":n>0?n+"分"+o+"秒 ":o+"秒 ";return{day:e,hour:i,minute:n,second:o,string:s}}},function(t,e){t.exports='<div class="order-product-arrival">\n  <p><i class="order-product-arrival-icon"></i><%= text %></p>\n  <p><%= beforeTime %>前下单并支付，</p>\n  <p>预计<strong><%= day %>（<%= date %>）</strong>送达</p>\n</div>\n'},function(t,e){t.exports='<table cellpadding="0" cellspacing="0" class="order-product-table">\n  <thead>\n  <tr>\n    <th class="order-product-table-name">\n      <div class="order-product-supplier">\n        供应商：<span class="order-product-supplier-name"><%= data.merchantName %></span>\n        <!--<div class="order-product-supplier-tips">由“<%= data.merchantName %>”负责发货，并提供售后服务</div>-->\n      </div>\n    </th>\n    <th class="order-product-table-price">单价</th>\n    <th class="order-product-table-num">数量</th>\n    <th class="order-product-table-total">小计</th>\n    <th class="order-product-table-express">配送方式</th>\n  </tr>\n  </thead>\n  <tbody></tbody>\n  <tfoot>\n  <tr>\n    <td colspan="5">\n      <div class="order-product-info">\n        <div class="order-product-invoice clearfix">\n          <% if (data.merchantId > 10000) { // 非魅族自营 纸质发票 %>\n          <label for="invoiceNo<%= data.merchantId %>" class="order-product-invoice-label">\n            <input class="order-product-invoice-checkbox" type="checkbox" id="invoiceNo<%= data.merchantId %>">\n            开具发票\n          </label>\n          <% } else { %>\n          <div class="order-product-invoice-type">\n            发票类型：电子发票<div class="order-product-invoice-icon"></div>\n          </div>\n          <% } %>\n          <div class="order-product-invoice-info<%= data.merchantId > 10000 ? \' hide\' : \'\' %>">\n            <p>发票抬头：<span class="order-product-invoice-title"><%= data.merchantId > 10000 ? \'个人\' : \'默认为收货人姓名\' %></span>\n              <span class="order-product-invoice-edit">修改</span></p>\n          </div>\n        </div>\n        <div class="order-product-remark">\n          <span class="order-product-remark-title">备注</span>\n          <textarea class="order-product-remark-input" placeholder="备注..." maxlength="45"></textarea>\n        </div>\n      </div>\n      <div class="order-product-total">\n        合计：<span class="order-product-price red"><%= data.merchantTotalMoney.toFixed(2) %></span>\n      </div>\n    </td>\n  </tr>\n  </tfoot>\n</table>\n'},function(t,e){t.exports='<tr>\n  <td class="order-product-table-name">\n    <a target="_blank" class="order-product-link" href="<%= skuInfo.itemUrl %>" data-mdesc="确认订单信息" data-mtype="store_se_ord">\n      <img class="order-product-image" src="<%= skuInfo.image %>@120x120.jpg">\n    </a>\n    <div class="order-product-name">\n      <a target="_blank" class="order-product-link" href="<%= skuInfo.itemUrl %>" data-mdesc="确认订单信息" data-mtype="store_se_ord">\n        <p class="order-product-name-item"><%= skuInfo.itemName %></p>\n        <p class="order-product-name-item"><%= skuInfo.cspuDesc %></p>\n        <% if (skuInfo.packageName) { %>\n        <p class="order-product-name-item order-product-group"><%= skuInfo.packageName %></p>\n        <% } %>\n      </a>\n    </div>\n  </td>\n  <td class="order-product-table-price">\n    <p>\n      <span class="order-product-price"><%= skuInfo.totalPrice.toFixed(2) %></span>\n      <% if (skuInfo.reduceMoney > 0) { %>\n      <span class="order-product-price cancel"><%= skuInfo.totalOriginPrice.toFixed(2) %></span>\n      <% } %>\n    </p>\n    <% if (skuInfo.reduceItems) { %>\n    <div>\n      <div class="order-product-discount<%= skuInfo.reduceItems.length > 1 ? \' more\' : \'\' %>">\n        <div class="order-product-discount-title">\n          <%= skuInfo.reduceItems.length > 1 ? \'优惠\' : skuInfo.reduceName[skuInfo.reduceItems[0].type] %>:\n          <span class="order-product-price sub"><%= skuInfo.reduceMoney.toFixed(2) %></span>\n          <% if (skuInfo.reduceItems.length > 1) { %>\n          <i class="order-product-discount-triangle"></i>\n          <% } %>\n        </div>\n        <% if (skuInfo.reduceItems.length > 1) { %>\n        <ul class="order-product-discount-downmenu">\n          <% skuInfo.reduceItems.forEach(function (reduce) {  %>\n          <li class="order-product-discount-item">\n            <%= skuInfo.reduceName[reduce.type]%>\n            <span class="order-product-price sub"><%= reduce.price.toFixed(2) %></span>\n          </li>\n          <% }) %>\n        </ul>\n        <% } %>\n      </div>\n    </div>\n    <% } %>\n    <% if (skuInfo.activeTimeEnd) { %>\n    <p class="order-product-countdown"></p>\n    <% } %>\n  </td>\n  <td class="order-product-table-num"><%= skuInfo.number %></td>\n  <td class="order-product-table-total">\n    <p class="order-product-price red"><%= skuInfo.payMoney.toFixed(2) %></p>\n  </td>\n  <% if (skuInfo.productIndex === 0) { %>\n  <td class="order-product-table-express" rowspan="999">\n    <p>\n      快递配送：运费<span class="order-product-price red"><%= skuInfo.merchantExpressFee.toFixed(2) %></span>\n    </p>\n  </td>\n  <% } %>\n</tr>\n<% skuInfo.skuInfoBoList.forEach(function (boItem, index) { %>\n<tr class="order-product-table-child<%= index === 0 ? \' first\' : \'\' %>">\n  <td class="order-product-table-name" colspan="4">\n    <a target="_blank" class="order-product-link" href="<%= boItem.itemUrl %>" data-mdesc="确认订单信息" data-mtype="store_se_ord">\n      <img class="order-product-image" src="<%= boItem.image %>">\n    </a>\n    <div class="order-product-name">\n      <a target="_blank" class="order-product-link" href="<%= boItem.itemUrl %>" data-mdesc="确认订单信息" data-mtype="store_se_ord">\n        <%= boItem.name %>\n      </a>\n    </div>\n  </td>\n</tr>\n<% }) %>\n'},function(t,e){t.exports='<div class="order-invoice-dialog-content">\n  <div class="order-invoice-dialog-row clearfix">\n    <div class="order-invoice-dialog-title must">发票类型</div>\n    <div class="order-invoice-dialog-content">\n      <% if (data.invoiceType === 2) { %>\n      <p class="order-invoice-dialog-content-wrap">电子发票</p>\n      <p class="order-invoice-dialog-desc">电子发票是税局认可的有效凭证，其法律效力、基本用途及使用规定同纸质发票。</p>\n      <% } else { %>\n      <p class="order-invoice-dialog-content-wrap">纸质发票</p>\n      <% } %>\n    </div>\n  </div>\n  <div class="order-invoice-dialog-row clearfix">\n    <div class="order-invoice-dialog-title must">发票抬头</div>\n    <div class="order-invoice-dialog-content">\n      <span class="order-invoice-dialog-type"></span>\n      <span class="mz-input-warp order-invoice-dialog-name">\n        <% if (data.invoiceType === 2) { %>\n        <input type="text" class="mz-input" disabled placeholder="默认发货人姓名" maxlength="45" name="name" value="">\n        <% } else { %>\n        <input type="text" class="mz-input" placeholder="默认发货人姓名" maxlength="45" name="name" value="个人">\n        <% } %>\n      </span>\n    </div>\n  </div>\n  <div class="order-invoice-dialog-row clearfix order-invoice-dialog-enterprise">\n    <div class="order-invoice-dialog-title must">纳税人识别号</div>\n    <div class="order-invoice-dialog-content mz-input-warp">\n      <input type="text" class="mz-input" placeholder="请输入纳税人识别号" maxlength="20" name="identifySn">\n    </div>\n  </div>\n  <div class="order-invoice-dialog-row clearfix order-invoice-dialog-enterprise">\n    <div class="order-invoice-dialog-title">开户行</div>\n    <div class="order-invoice-dialog-content mz-input-warp">\n      <input type="text" class="mz-input" placeholder="请输入开户行全称" maxlength="50" name="bank">\n    </div>\n  </div>\n  <div class="order-invoice-dialog-row clearfix order-invoice-dialog-enterprise">\n    <div class="order-invoice-dialog-title">开户行账号</div>\n    <div class="order-invoice-dialog-content mz-input-warp">\n      <input type="text" class="mz-input" placeholder="请输入开户行账号" maxlength="50" name="bankAccount">\n    </div>\n  </div>\n</div>\n'},function(t,e){t.exports="纳税人识别号：<%= data.invoiceIdentifySn %>\n<% if (data.invoiceBank || data.invoiceBankAccount) { %>\n开户行及账号：<%= data.invoiceBank %> <%= data.invoiceBankAccount.replace(/(.{4})/g, '$1 ') %>\n<% } %>\n"},function(t,e){t.exports='<ul class="einvoice-detail">\n  <li class="q">为什么要选择电子发票？</li>\n  <li class="a">电子发票是纳税义务人通过互联网录入数据，然后开具给客户。电子发票获取更便捷，可重复下载，避免丢失，方便查验，售后维权更有保障。发货效率更高，退换货更方便！电子发票低碳环保，节能减排，符合加强环境保护的国家策略。选择电子发票，省力省心，更能为环境保护贡献一份力。</li>\n  <li class="q">确保电子发票具有法律效力的相关规定有哪些?</li>\n  <li class="a">根据国家税务总局关于推行通过增值税电子发票系统开具的增值税电子普通发票有关问题的公告（国家税务总局公告2015年第84号）的规定，自2016年1月1日起启用。增值税电子普通发票的开票方和受票方需要纸质发票的，可以自行打印增值税电子普通发票的版式文件，其法律效力、基本用途、基本使用规定等与税务机关监制的增值税普通发票相同。</li>\n  <li class="q">怎样收到电子发票？</li>\n  <li class="a">2016年1月1日及之后发货的订单，电子发票将在订单发货后，由系统自动发送到收货人的手机，请留意查收；如未收到，请联系客服热线:400-788-3333或进入官网咨询：<a class="einvoice-detail-link" href="http://live-i.meizu.com/live800/chatClient/chatbox.jsp?companyID=8957&configID=4&enterurl=http://store.meizu.com/explain/einvoice_help.html&pagereferrer=&info=&k=1" target="_blank">在线客服</a>，无需操作后台；2016年1月1日前发货的订单，可在官网商城用户订单详情中查看发票信息。</li>\n  <li class="q">想要传统纸质发票怎么办？</li>\n  <li class="a">魅族商城正式启用电子发票后，不支持自主更换纸质发票。</li>\n  <li class="q">电子发票短信误删了怎么办？</li>\n  <li class="a">用户可联系客服索取电子发票信息，客服热线:400-788-3333或进入官网咨询：<a class="einvoice-detail-link" href="http://live-i.meizu.com/live800/chatClient/chatbox.jsp?companyID=8957&configID=4&enterurl=http://store.meizu.com/explain/einvoice_help.html&pagereferrer=&info=&k=1" target="_blank">在线客服</a>。</li>\n  <li class="q">电子发票是否可以用于报销？</li>\n  <li class="a">电子发票打印后可用于单位报销。</li>\n  <li class="q">电子发票在哪里下载和打印？</li>\n  <li class="a">2016年1月1日及之后发货的订单，电子发票用户可以登录<a class="einvoice-detail-link" href="http://t.cn/R4cdnja" target="_blank">http://t.cn/R4cdnja</a> 凭借短信信息查询电票发票。 2016年1月1日前发货的订单，电子发票依旧在<a class="einvoice-detail-link" href="http://t.cn/Rzm3kyC" target="_blank">http://t.cn/Rzm3kyC</a> 查询。</li>\n  <li class="q">选择开具电子发票的顾客如何办理退换货流程？</li>\n  <li class="a">和原有退换货流程一样，唯一区别是电子发票的用户在办理退换货时无需用户退回电子发票，我司直接按电子发票冲红处理。</li>\n  <li class="q">电子发票可以修改发票抬头吗？</li>\n  <li class="a">目前电子发票抬头默认为收货人姓名，如需修改，请联系客服热线:400-788-3333或进入官网咨询：<a class="einvoice-detail-link" href="http://live-i.meizu.com/live800/chatClient/chatbox.jsp?companyID=8957&configID=4&enterurl=http://store.meizu.com/explain/einvoice_help.html&pagereferrer=&info=&k=1" target="_blank">在线客服</a>。</li>\n</ul>\n';
},function(t,e,i){i(52);var n=i(7),o=i(11),s=i(53),r=i(57),a=i(61),c=0,d=0,l=0,u=0,p=null,h=null,v=null,m=n("#discount"),f=n("#discountList"),y=n("#totalRedRow"),g=n("#totalRepoRow"),x=n("#totalCouponRow"),b=n("#totalPayPrice"),k=function(t){var e=100*c,i=100*l,n=100*d,o=100*u,s=e-i-o-n;switch(t){case"repo":s+=i;break;case"coupon":s+=n;break;case"red":s+=o}return s/100},w=function(t,e){return!!((100*k(e)-100*t)/100<=0)},_=o.template(['<li class="order-discount-item">','<div class="order-discount-item-header" data-mdesc="<%= mdesc %>" data-mtype="<%= mtype %>" >','<div class="order-discount-item-title"></div>','<div class="order-discount-item-right"></div>',"</div>",'<div class="order-discount-item-content"></div>',"</li>"].join("")),$=function(t){return['<div class="order-discount-content-mask">','<div class="order-discount-content-tips">','<div class="order-discount-content-tips-header">无法选择</div>','<div class="order-discount-content-tips-content">'+t+"</div>","</div>","</div>"].join("")},C=".order-discount-item-right",I=".order-discount-item-title",T=".order-discount-item-header",z=".order-discount-item-content",A=function(){if(s.getCouponState()){var t=d>0?'<span class="order-discount-item-price">'+d.toFixed(2)+"</span>":"";d>0?x.show():x.hide(),n(C,p).html(t),n(".order-total-price",x).text(d.toFixed(2))}if(r.getRedState()){var e=u>0?'<span class="order-discount-item-price">'+u.toFixed(2)+"</span>":"";u>0?y.show():y.hide(),n(C,v).html(e),n(".order-total-price",y).text(u.toFixed(2))}var i=l>0?'<span class="order-discount-item-price">'+l.toFixed(2)+"</span>":"";l>0?g.show():g.hide(),n(C,h).html(i),n(".order-total-price",g).text(l.toFixed(2)),b.text(k().toFixed(2))},O=function(t,e){t=n(t);var i=n($(e)).css({display:"none"}).appendTo(t).fadeIn(400);setTimeout(function(){i.fadeOut(400)},2e3)},S=function(){f.on("click",T,function(){var t=n(this).parent(),e=t.data("type"),i=n(this).siblings(z),o=t.hasClass("open"),s=function(t,e){var i=e.siblings(".open");i.children(z).stop(!1,!0).slideUp(400,function(){i.removeClass("open")}),t.stop(!1,!0).slideDown(400),e.addClass("open")};o?i.stop(!1,!0).slideUp(400,function(){i.parent().removeClass("open")}):"repo"!=e||a.getRepoState()?s(i,t):a.getUserRepo(s.bind(null,i,t),m)}),a.event.on("updatePrice",function(t){l=t,A()}),a.event.on("error",O)},D=function(t,e,i){c=t,p=n(_({mdesc:"优惠券",mtype:"store_se_coupon"})).data("type","coupon"),s.init(w,e,n(z,p)),s.getCouponState()&&(n(I,p).text("使用优惠券"),p.addClass("open").appendTo(f),s.event.on("updatePrice",function(t){d=t,A()}),s.event.on("error",O)),v=n(_({mdesc:"红包",mtype:"store_se_rcoupon"})).data("type","red"),r.init(w,i,n(z,v)),r.getRedState()&&(n(I,v).text("使用红包"),v.appendTo(f),r.event.on("updatePrice",function(t){u=t,A()}),r.event.on("error",O)),h=n(_({mdesc:"回购券",mtype:"store_se_bcoupon"})).data("type","repo"),a.init(w,n(z,h)),n(I,h).text("使用回购券"),h.appendTo(f),S()};t.exports={init:D,coupon:s,red:r,repo:a}},1,function(t,e,i){i(54);var n=i(7),o=i(11),s=i(12),r=i(43),a=null,c=null,d=!1,l=0,u={},p=new s,h=n('<ul class="order-discount-coupon-list clearfix" />'),v=o.template(i(56)),m=function(){n.each(u,function(){n(this).removeClass("checked")}),c=null,l=0,p.emit("updatePrice",l)},f=function(t){return t.startDate=r(new Date(t.start),"yyyy.MM.dd hh:mm"),t.endDate=r(new Date(t.end),"yyyy.MM.dd hh:mm"),u[t.couponAcquirementId]=n(v(t)).on("click",function(e){if(n(e.target).hasClass("order-discount-coupon-range-link"))return window.open("//lists.meizu.com/page/couponItems/"+t.couponId+".html","_blank"),!1;if(n(this).hasClass("checked"))n(this).removeClass("checked"),c=null,l=0,p.emit("updatePrice",l);else{var i=a(t.reductionQuotaValue,"coupon");i?p.emit("error","body","抵扣金额超过订单金额"):(n(this).addClass("checked").siblings(".checked").removeClass("checked"),c=t.couponAcquirementId,l=t.reductionQuotaValue,p.emit("updatePrice",l))}}),u[t.couponAcquirementId]},y=function(t,e){return e.reductionQuotaValue-t.reductionQuotaValue},g=function(t){var e=0,i=null,o=[],s=[];n.each(t,function(t,e){1==e.couponType?o.push(e):s.push(e)}),o.sort(y),s.sort(y),t=o.concat(s);var r=n.map(t,function(t){var n=a(t.reductionQuotaValue,"coupon");return!n&&t.reductionQuotaValue>e&&(e=t.reductionQuotaValue,i=t.couponAcquirementId),f(t)});h.append(r),setTimeout(function(){i&&u[i].click()})},x=function(){return d},b=function(t,e,i){a=t,e&&e.length&&(d=!0,g(e),i.addClass("order-discount-coupon").html(h))},k=function(){return c};t.exports={init:b,event:p,clearCoupon:m,getCouponState:x,getUseCouponId:k}},1,,function(t,e){t.exports='<li class="order-discount-coupon-item">\n  <div class="order-discount-coupon-tick <%= couponType == 1 ? \'single\' : \'\' %>">\n    <div class="order-discount-coupon-top clearfix">\n      <div class="order-discount-coupon-top-row">\n        <div class="order-discount-coupon-price"><%= reductionQuotaValue.toFixed(2) %></div>\n        <div class="order-discount-coupon-type"><%= couponType == 1 ? \'单品券\' : \'多品券\' %></div>\n        </div>\n      <div>\n        <div class="order-discount-coupon-title" title="<%= name %>优惠券"><%= name %>优惠券</div>\n        <div class="order-discount-coupon-desc">满<%= consumptionQuota %>可用</div>\n        </div>\n      </div>\n    <div class="order-discount-coupon-bottom">\n      <div class="order-discount-coupon-time"><%= startDate %> - <%= endDate %></div>\n      <div class="clearfix">\n        <div class="order-discount-coupon-range-text" title="适用范围：<%= itemDesc %>">适用范围：<%= itemDesc %></div>\n        <a class="order-discount-coupon-range-link">查看适用></a>\n        </div>\n      </div>\n    </div>\n  <div class="order-discount-coupon-footer">\n    <div class="order-discount-coupon-checkbox"></div>\n  </div>\n</li>\n'},function(t,e,i){i(58);var n=i(7),o=i(11),s=i(12),r=i(43),a=null,c=!1,d=new s,l=0,u=null,p={},h=o.template(i(60)),v=n('<ul class="order-discount-red-list clearfix" />'),m=function(){n.each(p,function(){n(this).removeClass("checked")}),u=null,l=0,d.emit("updatePrice",l)},f=function(t){return t.startDate=r(new Date(t.start),"yyyy.MM.dd hh:mm"),t.endDate=r(new Date(t.end),"yyyy.MM.dd hh:mm"),p[t.redEnvelopeAcquirementId]=n(h(t)).on("click",function(){if(n(this).hasClass("checked"))n(this).removeClass("checked"),u=null,l=0,d.emit("updatePrice",l);else{var e=a(t.quotaValue,"red");e?d.emit("error","body","抵扣金额超过订单金额"):(n(this).addClass("checked").siblings(".checked").removeClass("checked"),u=t.redEnvelopeAcquirementId,l=t.quotaValue,d.emit("updatePrice",l))}}),p[t.redEnvelopeAcquirementId]},y=function(t){t.sort(function(t,e){return e.quotaValue-t.quotaValue});var e=n.map(t,f);v.append(e)},g=function(){return c},x=function(t,e,i){a=t,e&&e.length&&(c=!0,y(e),i.addClass("order-discount-red").append(v))},b=function(){return u};t.exports={init:x,event:d,clearRed:m,getRedState:g,getUseRedId:b}},1,,function(t,e){t.exports='<li class="order-discount-red-item">\n  <div class="order-discount-red-tick">\n    <div class="order-discount-red-price"><%= quotaValue.toFixed(2) %></div>\n    <div class="order-discount-red-name" title="<%= name %>红包"><%= name %>红包</div>\n    <div class="order-discount-red-time"><%= startDate %> - <%= endDate %></div>\n  </div>\n  <div class="order-discount-red-footer">\n    <div class="order-discount-red-checkbox"></div>\n  </div>\n</li>\n'},function(t,e,i){i(62);var n=i(7),o=i(11),s=i(8),r=i(29)(),a=i(14),c=i(12),d=o.template(['已选择<span class="order-discount-repo-selected-num"><%= repoNum %></span>',"张回购券（可多张叠加使用），总抵现",'<span class="order-discount-repo-selected-price"><%= repoPrice %></span>'].join("")),l='<ul class="order-discount-repo-list" />',u=['<div class="order-discount-repo-enter-row">','券号：<input type="text" class="order-discount-repo-enter-input">','密码：<input type="password" class="order-discount-repo-enter-input">','<div class="mz-btn success">确定</div>','<span class="order-discount-repo-tips"></span>',"</div>"].join(""),p=/^.{18}$/,h=!1,v=new s({type:"tips",title:"提示"}),m=new c,f=null,y=0,g=0,x={userTicks:{},inputTicks:{}},b={},k=null,w=n(l),_=n(l),$=n('<span class="order-discount-repo-enter-title">点击输入回购券</span>'),C=n('<div class="order-discout-repo-text" />'),I=n(u),T=n('<div class="order-discount-repo-enter-content" />').append(I,_),z=o.template(i(65)),A=function(){n.each(b,function(){n(this).removeClass("checked"),n(this).data("isSelected",!1)}),y=0,g=0,x={userTicks:{},inputTicks:{}},j(),m.emit("updatePrice",g)},O=function(t,e,i){if(i.data("isSelected"))i.data("isSelected",!1),y--,g=(100*g-100*e)/100,i.removeClass("checked"),x=t;else{var n=f(e);n?m.emit("error","body","抵扣金额超过订单金额"):(i.data("isSelected",!0),y++,g=(100*g+100*e)/100,i.addClass("checked"),x=t)}j(y,g),m.emit("updatePrice",g)},S=function(t,e){n.ajax({url:"/order/get_tickets.html",beforeSend:a.show.bind(null,e),timeout:1e4,success:function(i){a.hide(e),200==i.code?(h=!0,D(i.data),t()):v.show({content:i.message})},error:function(){a.hide(e),v.show({content:"网络错误"})}})},D=function(t){if(!n.isEmptyObject(t)){var e=n.map(t,function(t,e){return b[e]=n(z({price:t,sn:e.replace(e.substring(4,14),"****")})).on("click",function(){var i=n.extend(!0,{},x);n(this).data("isSelected")?delete i.userTicks[e]:i.userTicks[e]=t,O(i,t,n(this))}),b[e]});w.append(e)}},j=function(){C.html(d({repoNum:y,repoPrice:g.toFixed(2)}))},P=function(t,e){r.get(function(i,o){return i?void v.show({content:i}):void n.ajax({url:"/orders/query_repo.html",type:"post",headers:{"X-CSRF-TOKEN":o},data:{tick:t,password:e},beforeSend:a.show.bind(null,k),timeout:1e4,success:function(i){a.hide(k),200==i.code?(n("input[type=text]",I).val(""),n("input[type=password]",I).val(""),b[t]=n(z({price:i.data.tickPrice,sn:t.replace(t.substring(4,14),"****")})).on("click",function(){var o=n.extend(!0,{},x);n(this).data("isSelected")?delete o.inputTicks[t]:o.inputTicks[t]=e,O(o,i.data.tickPrice,n(this))}).appendTo(_)):m.emit("error","body",i.message||i.msg)},error:function(){a.hide(k),m.emit("error","body","网络错误")}})})},E=function(){var t=!1;$.on("click",function(){t?T.stop(!1,!0).slideUp(400,function(){t=!1}):T.stop(!1,!0).slideDown(400,function(){t=!0})}),I.on("click",".mz-btn",function(){var t=n("input[type=text]",I).val(),e=n("input[type=password]",I).val();if(p.test(t)&&""!=n.trim(e)){if(b[t])return void m.emit("error","body","该券已添加，请勿重复添加！");P(t,e)}else m.emit("error","body","请输入正确的卡号和密码！")})},M=function(){return h},R=function(){return y},q=function(){return x},F=function(t,e){f=t,j(),k=e.addClass("order-discount-repo").append(C,w,n("<p />").append($),T),E()};t.exports={init:F,event:m,clearRepo:A,getUserRepo:S,getRepoState:M,getUseRepoCount:R,getSelectedRepo:q}},1,,,function(t,e){t.exports='<li class="order-discount-repo-checkbox">\n  <div class="order-discount-repo-checkbox-title"></div>\n  <div class="order-discount-repo-checkbox-price"><%= price %></div>\n  <div class="order-discount-repo-checkbox-sn"><%= sn %></div>\n  <div class="order-discount-repo-checkbox-checked"></div>\n</li>\n'}]));