!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="//store.res.meizu.com//order/",e(0)}(function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))switch(typeof t[e]){case"function":break;case"object":t[e]=function(e){var n=e.slice(1),i=t[e[0]];return function(t,e,o){i.apply(this,[t,e,o].concat(n))}}(t[e]);break;default:t[e]=t[t[e]]}return t}([function(t,e,n){n(64);var i=n(7),o=JSON.parse(JSON.stringify(window.MZSTORECARTDATA)),s=n(65),a=n(69),c=n(76),r="checked",d=function(){var t=i(".JSelectAll");t.on("click",function(){var e=a.selectAll(),n=i(".mz-checkbox",t);e?n.addClass(r):n.removeClass(r)}),a.on("selectedAll",function(e){var n=i(".mz-checkbox",t);e?n.addClass(r):n.removeClass(r)})};o.cart&&(o.cart.merchants.length||o.cart.invalids.length)?(n(82),d(),s.init(),a.init(o.cart,o.timestamp)):c.init()},,,,,,,function(t,e){t.exports=meizuStoreGlobal.jquery},function(t,e,n){n(9);var i=n(7),o=n(11),s=n(12),a="hide",c=function(){return this._events={},s.apply(this,arguments),arguments.length?this.init.apply(this,arguments):this};c.prototype=new s,c.prototype.constructor=c,c.prototype._template=o.template(n(13),{variable:"data"}),c.prototype.defaultOptions={type:"dialog",hasClose:!0,title:"",content:"",contentTitle:"",buttons:[]},c.prototype.init=function(t){var e=this;return this.defaultOptions.buttons=[{type:"success",text:"确定",callback:function(){var t=!0;e.emit("beforeSuccess",function(){t=!1}),t&&(e.hide(),e.emit("success"))}}],"tips"!==t.type&&this.defaultOptions.buttons.push({type:"cancel",text:"取消",callback:function(){var t=!0;e.emit("beforeCancel",function(){t=!1}),t&&(e.hide(),e.emit("cancel"))}}),this.options=i.extend({},this.defaultOptions,t),this._init=!0,this},c.prototype._initDom=function(t){var e=this;return this.options=i.extend({},this.options,t||{}),this.$dialog=i(this._template(this.options)).appendTo("body"),i(".mz-dialog-content",this.$dialog).append(this.options.content),i(".mz-dialog-bottom .mz-btn",this.$dialog).on("click",function(){var t=i(this).index(),n=e.options.buttons[t].callback;i.isFunction(n)&&n.call(e)}),this.options.hasClose&&i(".mz-dialog-close",this.$dialog).on("click",function(){var t=!0;e.emit("beforeClose",function(){t=!1}),t&&(e.hide(),e.emit("close"))}),this},c.prototype.show=function(t,e){if(!this._init)return this.init(t).show(t,!0);if(!this.$dialog)return this._initDom(t).show(t,!0);if(t&&!e&&((t.type||t.className)&&i(".mz-dialog",this.$dialog).attr("class","mz-dialog").addClass((t.type||"")+" "+(t.className||"")),void 0!==t.hasClose&&(t.hasClose?i(".mz-dialog-close",this.$dialog).removeClass(a):i(".mz-dialog-close",this.$dialog).addClass(a)),void 0!==t.title&&i(".mz-dialog-title",this.$dialog).text(t.title),void 0!==t.content&&i(".mz-dialog-content",this.$dialog).empty().append(t.content),void 0!==t.contentTitle&&i(".mz-dialog-content-title",this.$dialog).text(t.contentTitle),i.isArray(t.buttons))){var n=t.buttons.map(function(t){if(i.isFunction(t.callback))throw new TypeError("Callback must be a function.");return i('<div class="mz-btn '+t.type+'">'+t.text+"</div>").on("click",t.callback.bind(this))});i(".mz-dialog-bottom",this.$dialog).empty().append(n)}var o=!0;return this.emit("beforeShow",function(){o=!1}),o&&(this.$dialog.removeClass(a),this.emit("show")),this},c.prototype.setPosition=function(){var t=i(".mz-dialog",this.$dialog),e=t.outerHeight(),n=t.outerWidth();t.css({marginLeft:-(n/2),marginTop:-(e/2)})},c.prototype.hide=function(){var t=!0;return this.emit("beforeHide",function(){t=!1}),t&&(this.emit("hide"),this.$dialog.addClass(a)),this},c.prototype.destroy=function(){var t=!0;return this.emit("beforeDestroy",function(){t=!1}),t&&(this.emit("destroy"),this.$dialog.remove()),this},t.exports=c},function(t,e){},,function(t,e){t.exports=meizuStoreGlobal.underscore},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!o(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,o,c,r,d;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var u=new Error('Uncaught, unspecified "error" event. ('+e+")");throw u.context=e,u}if(n=this._events[t],a(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:c=Array.prototype.slice.call(arguments,1),n.apply(this,c)}else if(s(n))for(c=Array.prototype.slice.call(arguments,1),d=n.slice(),o=d.length,r=0;r<o;r++)d[r].apply(this,c);return!0},n.prototype.addListener=function(t,e){var o;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned&&(o=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[t].length>o&&(this._events[t].warned=!0,"function"==typeof console.trace)),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function n(){this.removeListener(t,n),o||(o=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var o=!1;return n.listener=e,this.on(t,n),this},n.prototype.removeListener=function(t,e){var n,o,a,c;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],a=n.length,o=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(c=a;c-- >0;)if(n[c]===e||n[c].listener&&n[c].listener===e){o=c;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],i(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e){t.exports='<div class="mz-mask hide">\n  <div class="mz-dialog <%= data.type %> <%= data.className %>">\n    <div class="mz-dialog-header">\n      <div class="mz-dialog-title"><%= data.title %></div>\n      <div class="mz-dialog-close<%= data.hasClose ? \'\' : \'hide\' %>"></div>\n    </div>\n    <div class="mz-dialog-main">\n      <div class="mz-dialog-warp">\n        <% if (data.contentTitle) { %>\n        <div class="mz-dialog-content-title"><%= data.contentTitle %></div>\n        <% } %>\n        <div class="mz-dialog-content"></div>\n      </div>\n    </div>\n    <% if (data.buttons) { %>\n    <div class="mz-dialog-bottom">\n      <% data.buttons.forEach(function(btn) { %>\n      <div class="mz-btn <%= btn.type %>"><%= btn.text %></div>\n      <% }) %>\n    </div>\n    <% } %>\n  </div>\n</div>\n'},function(t,e,n){n(15);var i=n(7),o=n(17)("animation"),s='<div class="mz-loading-mask" />',a='<div class="mz-loading" />',c=['<div class="mz-bounce mz-bounce1"></div>','<div class="mz-bounce mz-bounce2"></div>','<div class="mz-bounce mz-bounce3"></div>'].join(""),r=function(t){var e=i(t||"body");"static"===e.css("position")&&"body"!==e.selector&&e.css("position","relative");var n=!1,r=e.children(".mz-loading-mask");r.length||(r=i(s),n=!0);var d=e.outerHeight(),u=e.outerWidth();if(r.css({width:u,height:d}),!n)return r.show();var l;return l=o?i(a).addClass("spinner").append(c):i(a).addClass("image"),r.append(l).appendTo(e)},d=function(t){var e=i(t||"body"),n=e.children(".mz-loading-mask");return!!n.length&&n.hide()};t.exports={show:r,hide:d}},9,,function(t,e){t.exports=function(t){var e,n=["webkit","Moz","ms","o"],i=[],o=document.documentElement.style,s=function(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})};for(e=0;e<n.length;e++)i.push(s(n[e]+"-"+t));for(i.push(s(t)),e=0;e<i.length;e++)if(i[e]in o)return!0;return!1}},,,,,,,,,,,function(t,e,n){var i=n(7),o=n(12),s=function(){return this._events={},o.apply(this,arguments),this.init.apply(this,arguments)};s.prototype=new o,s.prototype.constructor=s,s.prototype.defaultOptions={time:0,step:1,timeStep:1e3},s.prototype.init=function(t){if(this._isInit)return this;var e=this;return this._isInit=!0,this._cumulative=0,this.options=i.extend({},this.defaultOptions,t),this.on("count",function(t){e.options.time=t}),0!==this.options.time&&this.count(this.options.time),this},s.prototype._correct=function(t){if(!this._correctTime)return this._correctTime=+new Date,t;var e=+new Date,n=this.options.timeStep,i=e-n;if(this._cumulative+=i-this._correctTime,this._cumulative>=n){var o=Math.floor(this._cumulative/n);this._cumulative=this._cumulative%n,t-=o*this.options.step}return this._correctTime=e,t},s.prototype.count=function(t,e){if(!e&&this._counting)return!1;var n=this;return t=this._correct(t),this._counting=setTimeout(function(){var e=t-n.options.step;e=e>=0?e:0,n.emit("count",e,t),e>0?n.count(e,!0):(delete n.counting,n.emit("end"))},this.options.timeStep),this},s.prototype.pause=function(){return clearTimeout(this._counting),delete this._counting,this},s.prototype.proceed=function(){return this.count(this.options.time),this},s.prototype.stop=function(){return clearTimeout(this._counting),delete this._counting,delete this._correctTime,this._cumulative=0,this},s.prototype.start=function(t){return this.options=i.extend({},this.options,t),this.count(this.options.time),this},t.exports=s},function(t,e,n){var i=n(7),o=n(12),s=function(){return this._events={},o.apply(this,arguments),this.init.apply(this,arguments)};s.prototype=new o,s.prototype.constructor=s,s.prototype.init=function(t){return this.options=i.extend({},this.defaultOptions,t),this},s.prototype.defaultOptions={url:"/independent"},s.prototype.get=function(t,e){return!(!t||!i.isFunction(t))&&void i.ajax({url:this.options.url,type:"get",cache:!1,async:!e,success:function(e,n,i){if(200==e.code){var o=i.getResponseHeader("X-CSRF-TOKEN");t(null,o,i)}else t(e.error)},error:function(){t("网络错误")}})},s.prototype.async=function(){var t="";return this.get(function(e,n){if(e)throw Error(e);t=n},!0),t},t.exports=function(t){return new s(t)}},,,,,,,,,,,,,,,function(t,e){t.exports=function(t){var e=parseInt(t/864e5,10),n=parseInt((t-864e5*e)/36e5,10),i=parseInt((t-864e5*e-36e5*n)/6e4,10),o=parseInt((t-864e5*e-36e5*n-6e4*i)/1e3,10);e=e>0?e<10?"0"+e:e:0,n=n>0?n<10?"0"+n:n:0,i=i>0?i<10?"0"+i:i:0,o=o>0?o<10?"0"+o:o:0;var s=e>0?" "+e+"天"+n+"时"+i+"分"+o+"秒 ":n>0?" "+n+"时"+i+"分"+o+"秒 ":i>0?i+"分"+o+"秒 ":o+"秒 ";return{day:e,hour:n,minute:i,second:o,string:s}}},,,,,,,,,,,,,,,,,,,,9,function(t,e,n){n(66);var i="fixed",o=n(7),s=n(11),a=n(67).login,c=n(14),r=n(29)({url:"/getcsrf"}),d=n(8),u=n(67).cartInterface,l=n(68),p=n(69),m=n(76),h=s.template(n(81),{variable:"data"}),f=o("#cartFooter"),v=o("#totalCount"),g=o("#totalSelectedCount"),y=o("#totalDiscount"),k=o("#totalPrice"),_=o("#removeSelected"),b=o("#cartSubmit"),x=!1,I=new d({title:"提示",type:"tips"}),T=new d({title:"删除",content:"您确定要删除选中商品吗？",buttons:[{type:"cancel",text:"删除",callback:function(){var t=this,e=l.getSelected(),n=l.getSkus(),i=Object.keys(e).map(function(t){var n=e[t];return{id:n.cartItemId,skuId:n.skuId,packageId:n.packageId,packageSkuIds:n.packageStr}});c.show(this.$dialog),u.del(i,function(e){return e?(t.hide(),c.hide(t.$dialog),I.show({content:e})):(l.clear(),p.removeSelected(n),c.hide(t.$dialog),void t.hide())})}},{type:"success",text:"取消",callback:function(){this.hide()}}]}),w=function(){var t=l.getSelected();return Object.keys(t).sort(function(e,n){return t[e].thisIndex-t[n].thisIndex}).map(function(e){var n=t[e],i={skuId:n.skuId,numbers:n.quantity};return void 0!==n.packageId&&(i.packageId=n.packageId,i.packageList=n.packageStr),i})},S=function(){var t=l.getSelected();return Object.keys(t).map(function(e){var n=t[e],i={skuId:n.skuId,quantity:n.quantity};return void 0!==n.packageId&&(i.packageId=n.packageId,i.packageSkuIds=n.packageStr),i})},z=function(){var t=o(window).height(),e=p.$merchantList.offset().top+p.$merchantList.height()+80,n=o(window).scrollTop();t+n<e?f.addClass(i):f.removeClass(i)},$=function(){c.show("#cart"),r.get(function(t,e){return t?(x=!1,c.hide("#cart"),I.show({content:t})):void o.ajax({url:"/check",type:"post",headers:{"X-CSRF-TOKEN":e},data:JSON.stringify(S()),contentType:"application/json",success:function(t){2e3===t.code&&t.data?o(h({param:w()})).appendTo("body").submit():401===t.code?a.doLogin():I.once("success",function(){window.location.reload(!0)}).show({hasClose:!1,content:"部分商品已失效或库存不足，请重新确认"}),c.hide("#cart")},error:function(){x=!1,c.hide("#cart"),I.show({content:"网络错误"})}})})},C=function(){l.on("update",function(t,e,n){n?b.removeAttr("disabled"):b.attr("disabled","disabled"),g.html(n),y.html(e),k.html(t)}),b.on("click",function(){var t=l.getTotalSelectedCount();t&&(x||(x=!0,$()))}),_.on("click",function(){var t=l.getSkus();t.length?T.show():I.show({content:"请选择您要删除的商品"})}),p.on("productCount",function(t){t?(v.html(t),z()):m.init()}),o(window).on("resize scroll",z)},E=function(){C()};t.exports={init:E}},9,function(t,e){t.exports=meizuStoreGlobal},function(t,e,n){var i=n(7),o=n(12),s=n(67).cartInterface,a=new o,c={},r={},d=[],u=0,l=0,p=0,m=null,h=function(t,e,n){clearTimeout(m);var o=c[t];o&&o.quantity!==e.quantity?o.quantity=e.quantity:o||(d.push(t),o=r[t]=c[t]=i.extend({},e),o._singlePrice=o.totalPrice,n||_(t,!0)),o._subtotal=o._singlePrice*o.quantity,m=setTimeout(x,400)},f=[],v=[],g=null,y=null,k=5,_=function(t,e){if(clearTimeout(g),y&&(y.abort(),y=null),t)if(e){var n=v.indexOf(t);n!==-1?v.splice(n,1):f.indexOf(t)===-1&&f.push(t)}else{var i=f.indexOf(t);i!==-1?f.splice(i,1):v.indexOf(t)===-1&&v.push(t)}g=setTimeout(function(){var t=b(f,!0).concat(b(v,!1));t.length&&(y=s.select(t,function(t){return t?0===k?(k=5,!1):(k--,_()):(f=[],void(v=[]))}))},1e3)},b=function(t,e){return t.map(function(t){var n=r[t],i={id:n.cartItemId,skuId:n.skuId,selected:!!e};return void 0!==n.packageId&&(i.packageId=n.packageId,i.packageSkuIds=n.packageStr),i})},x=function(){return p=0,l=0,u=Object.keys(c).reduce(function(t,e){var n=c[e];return p+=n.quantity,l+=n._discount.reduce(function(t,e){return t+e.price*n.quantity},0),n._subtotal+t},0),a.emit("update",u.toFixed(2),l.toFixed(2),p),u},I=function(t){c[t]&&(clearTimeout(m),delete c[t],_(t),d.splice(d.indexOf(t),1),m=setTimeout(x,400))},T=function(){c={},d=[],x()},w=function(){return JSON.parse(JSON.stringify(c))},S=function(){return d},z=function(){return p},$=function(){return{price:u.toFixed(2),discount:l.toFixed(2),count:p}};t.exports={add:h,del:I,clear:T,getTotal:$,getSkus:S,getSelected:w,getTotalSelectedCount:z,on:a.on.bind(a)}},function(t,e,n){n(70);var i=n(7),o=n(11),s=n(12),a=n(8),c=n(71),r=n(14),d=n(28),u=n(67).cartInterface,l=n(44),p=n(68),m="checked",h=new s,f=i("#merchantList"),v=null,g=null,y=o.template(n(74),{variable:"data"}),k=o.template(n(75),{variable:"data"}),_=0,b=0,x=!1,I=!1,T={merchants:[],products:{},invalid:[],invalidSkuIds:[]},w=new a({type:"tips",title:"提示"}),S=new a({title:"删除",content:"您确定要删除该商品吗？",buttons:[{type:"cancel",text:"删除",callback:function(){this.__removeCallback()}},{type:"success",text:"取消",callback:function(){this.hide()}}]}),z=function(){var t,e,n=this.merchantKey,i=this.data.uniqueId;void 0!==n?(t=T.merchants[n].productSkuIds,e=T.merchants[n].products):(t=T.invalidSkuIds,e=T.invalid),this.countdown&&this.countdown.stop();var o=t.indexOf(i);t.splice(o,1),e.splice(o,1),this.checked&&p.del(i),delete T.products[i],0===t.length?void 0!==this.merchantKey?T.merchants[n].$selector.remove():g.remove():this.$selector.remove(),void 0!==n&&(L(n),F()),C()},$=function(t){t?this.addClass(m):this.removeClass(m)},C=function(){_=Object.keys(T.products).reduce(function(t,e){var n=T.products[e].data;return t+n.quantity},0),h.emit("productCount",_)},E=function(t){clearTimeout(v);var e=this.data.packagePrice?this.data.packagePrice+this.data.price:this.data.price;this.data.quantity=t,this.checked&&p.add(this.data.uniqueId,this.data),i(".cart-product-price.total",this.$selector).html((e*t).toFixed(2)),v=setTimeout(C,600)},L=function(t){var e=T.merchants[t],n=e.products.reduce(function(t,e){return!!e.checked&&t},!0);e.checked=n;var o=i(".cart-select-all .mz-checkbox",e.$selector);$.call(o,n)},O=function(t,e){e.forEach(function(e){e.checked=t,t?p.add(e.data.uniqueId,e.data):p.del(e.data.uniqueId);var n=i(".mz-checkbox",e.$selector);$.call(n,t)})},q=function(t,e,n){var o=[],s=[],a=!0,m=t.map(function(t){if(t.thisIndex=++n,t.merchantKey=e,t.packageId){var m=(t.packageSkus||[]).reduce(function(t,e){return t.push(e.skuId)&&t},[]);t.packageStr=m.join(","),t.uniqueId=t.skuId+"-"+t.packageId+"-"+m.join("-")}else t.packageStr=null,t.uniqueId=t.skuId;t._discount=[],t.packageDiscount&&t._discount.push({name:"套餐优惠",price:t.packageDiscount}),t.activity&&t._discount.push({name:"限时折扣优惠",price:t.originPrice-t.price});var h=i(k(t)),f=T.products[t.uniqueId]={$selector:h,merchantKey:e,data:t,checked:!!t.selected,adder:null};if(f.checked?p.add(t.uniqueId,t,!0):a=!1,_+=t.quantity,void 0!==e){if(f.adder=(new c).on("update",function(){u.edit({id:t.cartItemId,skuId:t.skuId,quantity:t.quantity,packageId:t.packageId,packageSkuIds:t.packageStr})}).on("updateSync",function(){i(".cart-product-number-max",h).removeClass("show"),E.apply(f,arguments)}).init({num:t.quantity,max:t.maxBuy}).on("max",function(){i(".cart-product-number-max",h).html("限购"+t.maxBuy+"件").addClass("show")}),i(".cart-product-number-adder",h).append(f.adder.$ele),t.activity){var v=i('<p class="cart-product-disabled-countdown" />').appendTo(i(".cart-col-price",h));f.countdown=new d({step:1e3}).on("end",function(){I=!0}).on("count",function(t){v.text("限时特惠：剩余"+l(t).string)}).count(t.activity.endTime-b)}i(".mz-checkbox",h).on("click",function(){f.checked=!f.checked,f.checked?p.add(t.uniqueId,t):p.del(t.uniqueId),$.call(i(this),f.checked),L(e),F()})}return i(".cart-product-remove",h).on("click",function(){S.__removeCallback=function(){var e=this;r.show(this.$dialog),u.del([{id:t.cartItemId,skuId:t.skuId,packageId:t.packageId,packageSkuIds:t.packageStr}],function(t){return t?(e.hide(),r.hide(e.$dialog),w.show({content:t})):(e.hide(),r.hide(e.$dialog),void z.call(f))})},S.show({content:"您确定要删除该商品吗？"})}),s.push(t.uniqueId),o.push(f),h});return{endIndex:n,$products:m,productSkuIds:s,productsData:o,isCheckedAll:a}},A=function(t){if(!t.length)return[];g=i(y({invalid:!0}));var e=q(t,void 0,0);return T.invalid=e.productsData,T.invalidSkuIds=e.productSkuIds,i(".cart-invalid-delete",g).on("click",function(){S.__removeCallback=function(){var t=this;r.show(this.$dialog),u.del(T.invalid.map(function(t){return{id:t.data.cartItemId,skuId:t.data.skuId,packageId:t.data.packageId,packageSkuIds:t.data.packageStr}}),function(e){return e?(t.hide(),r.hide(t.$dialog),w.show({content:e})):(g.remove(),T.invalidSkuIds.forEach(function(t){delete T.products[t]}),T.invalid=[],T.invalidSkuIds=[],C(),r.hide(t.$dialog),void t.hide())})},S.show({content:"您确定要删除这些商品吗？"})}),i(".cart-merchant-body",g).append(e.$products),g},N=function(t){var e=!0,n=0,o=t.map(function(t,o){var s=q(t.mainSkus,o,n);t.selected=s.isCheckedAll,n=s.endIndex;var a=i(y(t)),c={$selector:a,key:o,checked:s.isCheckedAll,data:t,productSkuIds:s.productSkuIds,products:s.productsData};return s.isCheckedAll||(e=!1),i(".cart-merchant-body",a).append(s.$products),i(".cart-select-all",a).on("click",function(){var t=i(".mz-checkbox",this);c.checked=!c.checked,$.call(t,c.checked),O(c.checked,s.productsData),F()}),T.merchants.push(c),a});return x=!!t.length&&e,o},j=function(){return x=!x,T.merchants.forEach(function(t){var e=i(".cart-select-all .mz-checkbox",t.$selector);t.checked=x,$.call(e,t.checked),O(t.checked,t.products)}),x},F=function(){x=T.merchants.reduce(function(t,e){return!!e.checked&&t},!0),h.emit("selectedAll",x)},D=function(){return _},P=function(){return I},K=function(t){t.forEach(function(t){z.call(T.products[t])})},U=function(t,e){b=e,f.append(N(t.merchants),A(t.invalids)),h.emit("productCount",_),h.emit("selectedAll",x)};t.exports={init:U,selectAll:j,$merchantList:f,getProductCount:D,getIsPriceOverTime:P,removeSelected:K,on:h.on.bind(h)}},9,function(t,e,n){n(72);var i=n(7),o=n(11),s=n(12),a=function(){return this._events={},s.apply(this,arguments),arguments.length>0?this.init.apply(this,arguments):this};a.prototype=new s,a.prototype.constructor=a,a.prototype._defaultOptions={min:1,num:1,max:500,callTime:600},a.prototype._template=o.template(n(73)),a.prototype.init=function(t){return this.options=i.extend(!0,{},this._defaultOptions,t),this.$ele=i(this._template({num:this.options.num})),this.$input=this.$ele.find(".mz-adder-input"),this._disSub=!1,this._disAdd=!1,this._speeding=!1,this._numberEmitTimeout=null,this._keyTimeInterval=null,this._rollbackVal=this.options.num,this.on("min",function(){this._disSub=!0,i(".mz-adder-subtract",this.$ele).addClass("disabled")}),this.on("max",function(){this._disAdd=!0,i(".mz-adder-add",this.$ele).addClass("disabled")}),this.on("updateSync",function(t){this._rollbackVal=t,i(".mz-adder-input",this.$ele).val(t),t>this.options.min&&(this._disSub=!1,i(".mz-adder-subtract",this.$ele).removeClass("disabled")),t<this.options.max&&(this._disAdd=!1,i(".mz-adder-add",this.$ele).removeClass("disabled"))}),this.options.num===this.options.min&&this.emit("min"),this.options.num===this.options.max&&this.emit("max"),this._bind(),this},a.prototype.addSpeeder=function(t){this._speeding=!0,this._keyTimeInterval=setTimeout(function(t){clearTimeout(this._numberEmitTimeout),this.options.num<this.options.max&&(this.options.num++,this.$input.val(this.options.num)),this.addSpeeder.call(this,t>0?t-8:0)}.bind(this,t),t)},a.prototype.subSpeeder=function(t){this._speeding=!0,this._keyTimeInterval=setTimeout(function(t){clearTimeout(this._numberEmitTimeout),this.options.num>this.options.min&&(this.options.num--,this.$input.val(this.options.num)),this.subSpeeder.call(this,t>0?t-8:0)}.bind(this,t),t)},a.prototype._bind=function(){var t=this;this.$ele.on("click",".mz-adder-subtract",function(){t._disSub||(t._speeding=!1,t._disAdd=!1,clearTimeout(t._keyTimeInterval),clearTimeout(t._numberEmitTimeout),t.options.num>t.options.min&&t.options.num--,t._numberEmitTimeout=setTimeout(function(){t.emit("update",t.options.num)},t.options.callTime),t.emit("updateSync",t.options.num),t.options.num===t.options.min&&t.emit("min"))}),this.$ele.on("mousedown",".mz-adder-subtract",function(){t._disSub||(t._disAdd=!1,t.subSpeeder.call(t,200))}),this.$ele.on("click",".mz-adder-add",function(){t._disAdd||(t._disSub=!1,t._speeding=!1,clearTimeout(t._keyTimeInterval),clearTimeout(t._numberEmitTimeout),t.options.num<t.options.max&&t.options.num++,t._numberEmitTimeout=setTimeout(function(){t.emit("update",t.options.num)},t.options.callTime),t.emit("updateSync",t.options.num),t.options.num===t.options.max&&t.emit("max"))}),this.$ele.on("mousemove",function(){t._speeding&&(t._speeding=!1,clearTimeout(t._numberEmitTimeout),clearTimeout(t._keyTimeInterval),t._numberEmitTimeout=setTimeout(function(){t.emit("update",t.options.num)},t.options.callTime),t.emit("updateSync",t.options.num),t.options.num===t.options.max&&t.emit("max"),t.options.num===t.options.min&&t.emit("min"))}),this.$ele.on("mousedown",".mz-adder-add",function(){t._disAdd||(t._disSub=!1,t.addSpeeder.call(t,200))});var e=null;this.$input.on("keypress",function(){clearTimeout(e);var n=i(this).val();/^\d+$/.test(n)&&n>=t.options.min&&n<=t.options.max&&(t._rollbackVal=parseInt(n,10))}),this.$input.on("input blur",function(){clearTimeout(e),clearTimeout(t._numberEmitTimeout),e=setTimeout(t.inputEvent.bind(this,t),300)}),this.$input.on("keyup",function(n){[37,38,39,40].indexOf(n.keyCode)===-1&&(clearTimeout(e),clearTimeout(t._numberEmitTimeout),e=setTimeout(t.inputEvent.bind(this,t),300))})},a.prototype.inputEvent=function(t){var e=i(this).val();return/^\d+$/.test(e)?void(e<t.options.max&&e>t.options.min?(t.options.num=parseInt(e,10),t._numberEmitTimeout=setTimeout(function(){t.emit("update",t.options.num)},t.options.callTime),t.emit("updateSync",t.options.num)):(t.options.num=e>=t.options.max?t.options.max:t.options.min,t._numberEmitTimeout=setTimeout(function(){t.emit("update",t.options.num)},t.options.callTime),t.emit("updateSync",t.options.num),t.emit(e>=t.options.max?"max":"min"))):(t.options.num=t._rollbackVal,t._numberEmitTimeout=setTimeout(function(){t.emit("update",t.options.num)},t.options.callTime),t.emit("updateSync",t.options.num),t.options.num===t.options.min&&t.emit("min"),t.options.num===t.options.max&&t.emit("max"),!1)},a.prototype.getNum=function(){return this.options.num},a.prototype.setNum=function(t){if(!/^\d+$/.test(t))throw new TypeError("num必须是数值");return t<=this.options.max&&t>=this.options.min&&this.$input.val(this.options.num=parseInt(t,10)),this},t.exports=a},9,function(t,e){t.exports='<div class="mz-adder">\n  <button class="mz-adder-subtract"></button>\n  <div class="mz-adder-num"><input type="text" class="mz-adder-input" value="<%= num %>"></div>\n  <button class="mz-adder-add"></button>\n</div>\n'},function(t,e){t.exports='<li class="cart-merchant<%= data.invalid ? \' disabled\' : \'\' %>">\n  <div class="cart-merchant-header">\n    <% if (data.invalid) { %>\n    失效商品\n    <div class="cart-invalid-delete" data-mdesc="删除全部失效商品" data-mtype="store_cart_invalid">全部删除</div>\n    <% } else { %>\n    <div class="cart-select-all">\n      <div class="mz-checkbox<%= data.selected ? \' checked\' : \'\' %>"></div>\n      <span class="cart-select-title"><%= data.merchantName %></span>\n    </div>\n    <% } %>\n  </div>\n  <table class="cart-merchant-body"></table>\n</li>\n'},function(t,e){t.exports='<tr class="cart-product">\n  <td class="cart-col-select">\n    <% if (data.merchantKey !== undefined) { %>\n    <div class="mz-checkbox<%= data.selected ? \' checked\' : \'\' %>"></div>\n    <% } else { %>\n    <span class="cart-product-disabled-label">失效</span>\n    <% } %>\n    <a href="<%= data.itemUrl %>" class="cart-product-link" target="_blank" data-mdesc="购物车商品位" data-mtype="store_cart_prod">\n      <img src="<%= data.image %>@120x120.png" class="cart-product-img" alt="<%= data.itemName %>">\n    </a>\n  </td>\n  <td class="cart-col-name">\n    <a href="<%= data.itemUrl %>" class="cart-product-link" target="_blank" data-mdesc="购物车商品位" data-mtype="store_cart_prod">\n      <p><%= data.itemName %></p>\n      <% if (data.packageName) { %>\n      <p><%= data.packageName %></p>\n      <% } %>\n      <span class="cart-product-desc"><%= data.cspuDesc %></span>\n    </a>\n  </td>\n  <td class="cart-col-price">\n    <p>\n      <span class="cart-product-price"><%= data.totalPrice.toFixed(2) %></span>\n      <% if (data.totalOriginPrice > data.totalPrice) { %>\n      <span class="cart-product-price origin"><%= data.totalOriginPrice.toFixed(2) %></span>\n      <% } %>\n    </p>\n    <% if (data._discount.length) { %>\n    <div class="cart-product-discount<%= data._discount.length > 1 ? \' child\' : \'\' %>">\n      <span class="cart-product-discount-title">\n        <%= data._discount.length > 1 ? \'优惠\' : data._discount[0].name %>:\n        <span class="cart-product-price sub">\n          <%= (data._discount.length > 1 ? data._discount.reduce(function(p,a){ return p + a.price }, 0) : data._discount[0].price).toFixed(2) %>\n        </span>\n        <% if(data._discount.length > 1) { %>\n        <i class="cart-product-discount-triangle"></i>\n        <% } %>\n      </span>\n      <% if (data._discount.length > 1) { %>\n      <ul class="cart-product-discount-list">\n        <% data._discount.forEach(function (discount) { %>\n        <li class="cart-product-discount-item">\n          <%= discount.name %>\n          <span class="cart-product-price sub"><%= discount.price.toFixed(2) %></span>\n        </li>\n        <% }) %>\n      </ul>\n      <% } %>\n    </div>\n    <% } %>\n  </td>\n  <td class="cart-col-number">\n    <% if (data.merchantKey === undefined) { %>\n    <%= data.quantity %>\n    <% } else { %>\n    <div class="cart-product-number-adder">\n      <p class="cart-product-number-max show">\n        <% if (data.shortageNum && data.shortageNum > 0)  { %>\n          <span class="cart-product-number-red">库存紧张</span>\n        <% } else if (data.quantity == data.maxBuy) { %>\n          限购<%= data.maxBuy %>件\n        <% } %>\n      </p>\n    </div>\n    <% } %>\n  </td>\n  <td class="cart-col-total">\n    <span class="cart-product-price total"><%= data.subtotal.toFixed(2) %></span>\n  </td>\n  <td class="cart-col-ctrl"><div class="cart-product-remove" data-mdesc="删除单个商品按钮" data-mtype="store_cart_del"></div></td>\n</tr>\n<% if (data.packageSkus) { %>\n<% data.packageSkus.forEach(function (child) { %>\n<tr class="cart-product child">\n  <td class="cart-col-select">\n    <a href="<%= child.itemUrl %>" class="cart-product-link" target="_blank" data-mdesc="购物车商品位" data-mtype="store_cart_prod">\n      <img src="<%= child.image %>@80x80.png" class="cart-product-img" alt="">\n    </a>\n  </td>\n  <td class="cart-col-name" colspan="5">\n    <a href="<%= child.itemUrl %>" class="cart-product-link" target="_blank" data-mdesc="购物车商品位" data-mtype="store_cart_prod">\n      <%= child.itemName %> <%= child.cspuDesc %>\n    </a>\n  </td>\n</tr>\n<% }) %>\n<% } %>\n'},function(t,e,n){n(77);var i=n(7),o=n(11),s=n(67).login,a=i("#cart"),c=o.template(n(80),{variable:"data"}),r=function(){a.html(c({login:s.isLogin}))};t.exports={init:r}},9,,,function(t,e){t.exports='<div class="mzcontainer">\n  <div class="cart-empty <%= data.login ? \' login\' : \'\' %>">\n    <div class="cart-empty-content">\n      <div class="cart-empty-left"></div>\n      <div class="cart-empty-right">\n        <div class="cart-empty-title">\n          <% if (data.login) { %>\n          购物车内还没有商品，赶紧去选购吧~\n          <% } else { %>\n          您还没有登录！\n          <% } %>\n        </div>\n        <% if (!data.login) { %>\n        <div class="cart-empty-desc">登录后可显示您账号中已加入的商品哦~</div>\n        <% } %>\n        <div class="tips-btn">\n          <% if (data.login) { %>\n          <a class="mz-btn primary" href="//store.meizu.com/index.html" data-mdesc="已登录且购物车为空返回商城首页按钮\t" data-mtype="store_cart_empty_index">返回商城首页</a>\n          <% } else { %>\n          <a class="mz-btn success l" href="javascript:window.location.href=\'https://login.flyme.cn/vCodeLogin?sid=unionlogin&service=store&autodirct=true&useruri=http://store.meizu.com/member/login.htm?useruri=\'+ encodeURIComponent(encodeURIComponent(window.location.href));" data-mdesc="未登录且购物车为空时提示用户登录" data-mtype="store_cart_empty_login">去登录</a>\n          <% } %>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},function(t,e){t.exports='<form action="//ordercenter.meizu.com/order/add.html" method="post" style="display: none">\n  <input type="hidden" value="<%- JSON.stringify(data.param) %>" name="cart_param">\n  <input type="hidden" value="cart" name="buy_from">\n</form>\n';
},function(t,e,n){n(83);var i=n(7),o=i("#cartLoginTips"),s=n(67).login;s.isLogin||(o.addClass("show"),o.on("click",".mz-btn",function(){s.doLogin()}))},9]));